# 功能扩展建议（Feature Roadmap）

基于当前应用已实现的功能，以下是推荐增加的功能，按优先级和实现难度分类。

---

## 🎯 高优先级（用户体验提升）

### 1. 收藏与最近阅读 ✅ 已实现

**描述**：允许用户收藏常用文档，记录最近阅读历史。

**已实现功能**：
- ✅ 文档级收藏：在"备忘清单"页点击五角星按钮收藏/取消收藏
- ✅ 目录列表标记：收藏文档显示"收藏"标记（黄色），最近阅读显示"最近"标记（绿色）
- ✅ 智能排序：目录页按"收藏 → 最近阅读 → 字典序"顺序显示
- ✅ 最近阅读：自动记录最近打开的 5 个文档
- ✅ 数据持久化：使用 Preferences 保存收藏和阅读历史

**技术实现**：
- 使用 Preferences 持久化收藏列表（favoriteDocIds）和阅读历史（recentDocIds）
- 在 Index.ets 中添加 `isDocFavorite`、`toggleDocFavorite`、`isDocRecent`、`addToRecentDocs` 方法
- 修改 `getCatalogDocsForDisplay` 实现分组排序

**工作量**：0.5 天

---

### 2. 全局搜索

**描述**：支持跨文档搜索，一次搜索所有文档内容。

**功能点**：
- 搜索框支持全局/当前文档切换
- 搜索结果按文档分组展示
- 点击结果直接跳转到对应文档和卡片
- 搜索历史记录

**技术实现**：
- 构建时生成搜索索引（可选，提升性能）
- 运行时遍历所有文档 JSON 进行匹配

**预估工作量**：2-3 天

---

### 3. 字号调节

**描述**：允许用户自定义阅读字号大小。

**功能点**：
- 设置页添加字号调节滑块（小/中/大/特大）
- 实时预览效果
- 持久化用户选择

**技术实现**：
- 当前 `fontSize` 已作为状态变量，只需添加 UI 控制
- 使用 Preferences 保存设置

**预估工作量**：0.5 天

---

### 4. 代码复制功能

**描述**：为代码块添加一键复制按钮。

**功能点**：
- 代码卡片右上角显示复制按钮
- 点击后复制代码到剪贴板
- 显示"已复制"提示

**技术实现**：
- 使用 `pasteboard` API（已在项目中使用）
- 修改 `ReferenceCard` 组件

**预估工作量**：0.5 天

---

## 📚 中优先级（功能增强）

### 5. 分类标签系统

**描述**：为文档添加分类标签，便于按类别浏览。

**功能点**：
- 文档分类：编程语言、工具、框架、数据库等
- 目录页添加分类筛选器
- 标签云展示

**技术实现**：
- 在 manifest.json 中添加 `category` 字段
- 修改同步脚本自动识别或手动配置分类

**预估工作量**：1-2 天

---

### 6. 阅读进度记录

**描述**：记录用户在每个文档的阅读位置，下次打开自动恢复。

**功能点**：
- 记录当前滚动位置（章节 + 卡片索引）
- 文档列表显示阅读进度百分比
- 支持"继续阅读"快捷入口

**技术实现**：
- 使用 Preferences 保存每个文档的阅读位置
- 监听列表滚动事件更新进度

**预估工作量**：1 天

---

### 7. 笔记与批注

**描述**：允许用户为卡片添加个人笔记。

**功能点**：
- 长按卡片弹出"添加笔记"选项
- 笔记内容本地保存
- 带笔记的卡片显示标记
- 笔记管理页面

**技术实现**：
- 新增 `NoteRepository` 管理笔记数据
- 使用 Preferences 或 RDB 持久化

**预估工作量**：2-3 天

---

### 8. 测验错题本

**描述**：收集测验中答错的题目，支持针对性复习。

**功能点**：
- 自动记录错题
- 错题本页面展示
- 支持仅练习错题模式
- 错题掌握后可移除

**技术实现**：
- 扩展 `QuizRepository` 添加错题记录
- 新增错题复习 UI

**预估工作量**：1-2 天

---

### 9. 文档更新检测

**描述**：检测在线文档是否有更新，提示用户刷新。

**功能点**：
- 定期检查在线 MD 文件的更新时间
- 显示"有更新"标记
- 一键刷新文档内容

**技术实现**：
- HTTP HEAD 请求检查 Last-Modified
- 对比本地缓存时间

**预估工作量**：1 天

---

## 🚀 低优先级（锦上添花）

### 10. 分享功能

**描述**：分享单个卡片或整个文档链接。

**功能点**：
- 长按卡片分享为图片或文本
- 分享文档链接（在线文档）
- 生成分享卡片图片

**技术实现**：
- 使用系统分享 API
- 截图或文本拼接

**预估工作量**：1-2 天

---

### 11. 语音朗读

**描述**：支持 TTS 朗读卡片内容。

**功能点**：
- 卡片添加"朗读"按钮
- 支持暂停/继续
- 朗读速度调节

**技术实现**：
- 使用 HarmonyOS TTS API

**预估工作量**：1-2 天

---

### 12. 小组件（Widget）

**描述**：桌面小组件显示每日速查卡片。

**功能点**：
- 每日随机展示一张卡片
- 点击跳转到对应文档
- 支持多种尺寸

**技术实现**：
- 创建 FormAbility
- 定时更新小组件内容

**预估工作量**：2-3 天

---

### 13. 数据导入导出

**描述**：支持备份和恢复用户数据。

**功能点**：
- 导出：收藏、笔记、测验记录、设置
- 导入：从备份文件恢复
- 支持 JSON 格式

**技术实现**：
- 文件读写 API
- 数据序列化/反序列化

**预估工作量**：1-2 天

---

### 14. 多主题扩展

**描述**：增加更多主题配色方案。

**功能点**：
- 新增主题：护眼绿、深蓝、紫罗兰等
- 自定义主题颜色
- 跟随系统主题

**技术实现**：
- 扩展 `appTheme.ets` 添加更多主题配置
- 监听系统主题变化

**预估工作量**：1 天

---

### 15. 离线文档管理

**描述**：允许用户选择性下载/删除离线文档。

**功能点**：
- 显示每个文档占用空间
- 支持删除不常用文档释放空间
- 重新下载已删除文档

**技术实现**：
- 动态管理 rawfile 数据（需要额外存储位置）
- 或使用应用沙箱存储

**预估工作量**：2-3 天

---

## 📊 功能优先级矩阵

| 功能 | 用户价值 | 实现难度 | 推荐优先级 |
|------|----------|----------|------------|
| 收藏与最近阅读 | ⭐⭐⭐⭐⭐ | ⭐⭐ | P0 |
| 全局搜索 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | P0 |
| 字号调节 | ⭐⭐⭐⭐ | ⭐ | P0 |
| 代码复制 | ⭐⭐⭐⭐ | ⭐ | P0 |
| 分类标签 | ⭐⭐⭐⭐ | ⭐⭐ | P1 |
| 阅读进度 | ⭐⭐⭐⭐ | ⭐⭐ | P1 |
| 笔记批注 | ⭐⭐⭐ | ⭐⭐⭐ | P1 |
| 测验错题本 | ⭐⭐⭐⭐ | ⭐⭐ | P1 |
| 文档更新检测 | ⭐⭐⭐ | ⭐⭐ | P2 |
| 分享功能 | ⭐⭐⭐ | ⭐⭐ | P2 |
| 语音朗读 | ⭐⭐ | ⭐⭐⭐ | P2 |
| 桌面小组件 | ⭐⭐⭐ | ⭐⭐⭐ | P2 |
| 数据导入导出 | ⭐⭐⭐ | ⭐⭐ | P2 |
| 多主题扩展 | ⭐⭐ | ⭐ | P2 |
| 离线文档管理 | ⭐⭐ | ⭐⭐⭐ | P3 |

---

## 🛠 技术债务与优化建议

### 代码优化

1. **组件拆分**：`Index.ets` 文件过大（2600+ 行），建议拆分为独立组件文件
2. **状态管理**：考虑使用 `@StorageLink` 或 `AppStorage` 简化跨组件状态共享
3. **性能优化**：大文档列表考虑虚拟滚动优化

### 用户体验优化

1. **加载状态**：添加骨架屏或更精细的加载动画
2. **空状态**：优化无数据时的空状态展示
3. **手势支持**：添加左右滑动切换文档/卡片
4. **动画效果**：页面切换和卡片展开添加过渡动画

### 可访问性

1. **无障碍支持**：添加 accessibilityText 属性
2. **大字体模式**：适配系统大字体设置
3. **高对比度模式**：支持系统高对比度主题


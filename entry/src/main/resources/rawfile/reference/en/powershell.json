{
  "id": "powershell",
  "name": "PowerShell",
  "title": "This is a quick reference cheat sheet to getting started with PowerShell scripting.",
  "icon": "https://raw.githubusercontent.com/Fechin/reference/main/source/assets/icon/powershell.svg",
  "sections": [
    {
      "id": "intro",
      "title": "Intro",
      "startIndex": 0
    },
    {
      "id": "s1",
      "title": "Basic Commands",
      "startIndex": 1
    },
    {
      "id": "s2",
      "title": "System Management",
      "startIndex": 29
    },
    {
      "id": "s3",
      "title": "Scripting",
      "startIndex": 34
    },
    {
      "id": "s4",
      "title": "Also see",
      "startIndex": 47
    }
  ],
  "cards": [
    {
      "id": "intro-0",
      "sectionId": "intro",
      "title": "Intro",
      "body": "This is a quick reference cheat sheet to getting started with PowerShell scripting."
    },
    {
      "id": "s1-1",
      "sectionId": "s1",
      "title": "Helper Commands",
      "body": "**_Powershell follows Verb-Noun format for their commands._**\n\nSome common Verbs:\n\n| Verb    | Description                                       |\n| ------- | ------------------------------------------------- |\n| Get     | Used to retrieve information.                     |\n| Set     | Used to configure or change settings.             |\n| New     | Used to create new instances of objects.          |\n| Remove  | Used to delete or remove items.                   |\n| Invoke  | Used to execute a specific action or operation.   |\n| Start   | Used to initiate a process or operation.          |\n| Stop    | Used to halt or terminate a process or operation. |\n| Enable  | Used to activate or enable a feature.             |\n| Disable | Used to deactivate or disable a feature.          |\n| Test    | Used to perform tests or checks.                  |\n| Update  | Used to update or refresh data or configurations. |\n\nLists available modules\n\n```powershell\nGet-Module --ListAvailable\n```\n\nLists available cmdlets and functions.\n\n```powershell\nGet-Command -Module ActiveDirectory\n```\n\nRetrieves help\n\n```powershell\nGet-Help <cmd>\nGet-Help <cmd> -Examples\nGet-Help -Name Get-Process -Parameter Id\n```\n\nLists aliases and their corresponding cmdlet names.\n\n```powershell\nGet-Alias | Select-Object Name, Definition\n```\n\n**Get-Member:** Displays the properties and methods of objects.\n\n```powershell\nGet-Process | Get-Member\n```"
    },
    {
      "id": "s1-14",
      "sectionId": "s1",
      "title": "Object%20Manipulation",
      "body": "**Select-Object%3A**%20Selects%20specific%20properties%20from%20objects%20or%20customizes%20their%20display.%0A%0A%60%60%60powershell%0AGet-Process%20%7C%20Select-Object%20Name%2C%20CPU%0A%60%60%60%0A%0A**Where-Object%3A**%20Filters%20objects%20based%20on%20specified%20conditions.%0A%0A%60%60%60powershell%0AGet-Service%20%7C%20Where-Object%20%7B%20%24PSItem.Status%20-eq%20'Running'%20%7D%0A%23OR%0AGet-Service%20%7C%20%3F%20%7B%20%24_.Status%20-eq%20'Running'%20%7D%0A%60%60%60%0A%0A**Measure-Object%3A**%20Calculates%20statistics%2C%20like%20sum%2C%20average%2C%20and%20count%2C%20for%20object%20properties.%0A%0A%60%60%60powershell%0AGet-Process%20%7C%20Measure-Object%20-Property%20WorkingSet%20-Sum%0A%60%60%60%0A%0A**ForEach-Object%3A**%20Performs%20an%20operation%20on%20each%20object%20in%20a%20collection.%20(BEAWARE%3A%20Below%20command%20will%20prefix%20of%0Afiles%2Ffolder%20in%20the%20current%20dir)%0A%0A%60%60%60powershell%0AGet-ChildItem%20%7C%20ForEach-Object%20%7B%20Rename-Item%20%24_%20-NewName%20%22Prefix_%24_%22%20%7D%0A%60%60%60%0A%0A**Sort-Object%3A**%20Sorts%20objects%20by%20specified%20properties.%0A%0A%60%60%60powershell%0AGet-ChildItem%20%7C%20Sort-Object%20Length%20-Descending%0A%60%60%60%0A%0A**Format-Table%3A**%20Formats%20output%20as%20a%20table%20with%20specified%20columns.%0A%0A%60%60%60powershell%0AGet-Service%20%7C%20Format-Table%20-AutoSize%20%20%23%20ft%20alias%0A%60%60%60%0A%0A**Format-List%3A**%20Formats%20output%20as%20a%20list%20of%20properties%20and%20values.%0A%0A%60%60%60powershell%0AGet-Process%20%7C%20Format-List%20-Property%20Name%2C%20CPU%20%20%23%20fl%20alias%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s1-28",
      "sectionId": "s1",
      "title": "FileSystem",
      "body": "%60%60%60powershell%0ANew-Item%20-path%20file.txt%20-type%20'file'%20-value%20'contents'%0ANew-Item%20-path%20file.txt%20-type%20'dir'%0ACopy-Item%20%3Csrc%3E%20-destination%20%3Cdest%3E%0AMove-Item%20-path%20%20%3Csrc%3E%20-destination%20%3Cdest%3E%0ARemove-Item%20%3Cfile%3E%0ATest-Path%20%3Cpath%3E%0ARename-Item%20-path%20%3Cpath%3E%20-newname%20%3Cnewname%3E%0A%0A%23%20using%20.NET%20Base%20Class%20Library%0A%5BSystem.IO.File%5D%3A%3AWriteAllText('test.txt'%2C%20'')%0A%5BSystem.IO.File%5D%3A%3ADelete('test.txt')%0A%0AGet-Content%20-Path%20%22test.txt%22%0AGet-Process%20%7C%20Out-File%20-FilePath%20%22processes.txt%22%23%20Output%20to%20file%0AGet-Process%20%7C%20Export-Csv%20-Path%20%22processes.csv%22%20%20%23%20Output%20to%20csv%0A%24data%20%3D%20Import-Csv%20-Path%20%22data.csv%22%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Import%20from%20csv%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s2-29",
      "sectionId": "s2",
      "title": "Windows Management Instrumentation",
      "body": "```powershell\n# Retrieve BIOS information\nGet-CimInstance -ClassName Win32_BIOS\n# Retrieve information about locally connected physical disk devices\nGet-CimInstance -ClassName Win32_DiskDrive\n# Retrieve information about install physical memory (RAM)\nGet-CimInstance -ClassName Win32_PhysicalMemory\n# Retrieve information about installed network adapters (physical + virtual)\nGet-CimInstance -ClassName Win32_NetworkAdapter\n# Retrieve information about installed graphics / video card (GPU)\nGet-CimInstance -ClassName Win32_VideoController\n\n# List all the classNames\nGet-CimClass | Select-Object -ExpandProperty CimClassName\n# Explore the various WMI classes available in the root\\cimv2 namespace\nGet-CimClass -Namespace root\\cimv2\n# Explore the child WMI namespaces underneath the root\\cimv2 namespace\nGet-CimInstance -Namespace root -ClassName __NAMESPACE\n\n\n```"
    },
    {
      "id": "s2-30",
      "sectionId": "s2",
      "title": "Network Management",
      "body": "```powershell\n# Test network connectivity to a remote host\nTest-Connection -ComputerName google.com\n\n# Retrieve network adapter information\nGet-NetAdapter\n\n# Retrieve IP address information\nGet-NetIPAddress\n\n# Retrieve routing table information\nGet-NetRoute\n\n# Test if a port is open on a remote host\nTest-NetConnection google.com -Port 80\n\n```"
    },
    {
      "id": "s2-31",
      "sectionId": "s2",
      "title": "User%20%26%20Group%20Management",
      "body": "%60%60%60powershell%0A%23%20Retrieve%20local%20user%20account%20information%0AGet-LocalUser%0A%0A%23%20Create%20a%20new%20local%20user%20account%0ANew-LocalUser%20-Name%20NewUser%20-Password%20(ConvertTo-SecureString%20%22Password123%22%20-AsPlainText%20-Force)%0A%0A%23%20Remove%20a%20local%20user%20account%0ARemove-LocalUser%20-Name%20UserToRemove%0A%0A%23%20Retrieve%20local%20group%20information%0AGet-LocalGroup%0A%0A%23%20Add%20a%20member%20to%20a%20local%20group%0AAdd-LocalGroupMember%20-Group%20Administrators%20-Member%20UserToAdd%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s2-32",
      "sectionId": "s2",
      "title": "Security & Permissions",
      "body": "```powershell\n# Retrieve access control lists for file/dir\nGet-Acl C:\\Path\\To\\File.txt\n\n# Set access control lists for a file/dir\nSet-Acl -Path C:\\Path\\To\\File.txt -AclObject $aclObject\n```"
    },
    {
      "id": "s2-33",
      "sectionId": "s2",
      "title": "Registry%20Management",
      "body": "%60%60%60powershell%0A%23%20Retrieve%20registry%20key%20values%0AGet-ItemProperty%20-Path%20%22HKLM%3A%5CSoftware%5CMicrosoft%5CWindows%5CCurrentVersion%5CUninstall%5C*%22%20%7C%20Select%20DisplayName%2C%20DisplayVersion%0A%0A%23%20Set%20registry%20key%20values%0ASet-ItemProperty%20-Path%20%22HKLM%3A%5CSoftware%5CMyApp%22%20-Name%20%22SettingName%22%20-Value%20%22NewValue%22%0A%0A%23%20Create%20a%20new%20registry%20key%20value%0ANew-ItemProperty%20-Path%20%22HKCU%3A%5CSoftware%5CMyApp%22%20-Name%20%22NewSetting%22%20-Value%20%22NewValue%22%20-PropertyType%20String%0A%0A%23%20Remove%20a%20registry%20key%20value%0ARemove-ItemProperty%20-Path%20%22HKCU%3A%5CSoftware%5CMyApp%22%20-Name%20%22SettingToRemove%22%0A%0A%23%20Check%20if%20a%20registry%20key%20exists%0ATest-Path%20%22HKLM%3A%5CSoftware%5CMyApp%22%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-34",
      "sectionId": "s3",
      "title": "Variables",
      "body": "Initializing%20a%20variable%20with%2Fwithout%20a%20specified%20type%3A%0A%0A%60%60%60powershell%0A%24var%20%3D%200%0A%5Bint%5D%20%24var%20%3D%20'Trevor'%20%20%20%20%20%20%20%20%20%23%20(throws%20an%20exception)%0A%5Bstring%5D%20%24var%20%3D%20'Trevor'%20%20%20%20%20%20%23%20(doesn't%20throw%20an%20exception)%0A%24var.GetType()%0A%0A%23%20Multiple%20Assigning%0A%24a%2C%24b%2C%24c%20%3D%20'a'%2C'b'%2C'c'%0A%0A%23%20Create%20an%20array%0A%24arrayvar%20%3D%20%40('va1'%2C'va2')%0A%0A%23%20Create%20dict%0A%24dict%20%3D%20%40%7Bk1%20%3D%20'test'%3B%20k2%20%3D%20'best'%7D%0A%60%60%60%0A%0AVariable%20Commands%0A%0A%60%60%60powershell%0ANew-Variable%20-Name%20FirstName%20-Value%20Trevor%0ANew-Variable%20FirstName%20-Value%20Trevor%20-Option%20%3CReadOnly%2FConstant%3E%0A%0AGet-Variable%0AGet-Variable%20%7C%20%3F%20%7B%20%24PSItem.Options%20-contains%20'constant'%20%7D%0AGet-Variable%20%7C%20%3F%20%7B%20%24PSItem.Options%20-contains%20'readonly'%20%7D%0A%0ARemove-Variable%20-Name%20firstname%0A%23%20Removes%20ReadOnly%20var%0ARemove-Variable%20-Name%20firstname%20-Force%0A%60%60%60%0A%0AVariable%20types%20int32%2C%20int64%2C%20string%2C%20bool",
      "encoded": true
    },
    {
      "id": "s3-39",
      "sectionId": "s3",
      "title": "Operators",
      "body": "%60%60%60powershell%0A%23%20operators%0A%23%20(a%20%3Cop%3E%20b)%0A%0A%3D%20%2C%20%2B%3D%20%2F%20-%3D%20%2C%20%2B%2B%20%2F%20--%0A-eq%20%2F%20-ne%20%2C%20-lt%20%2F%20-gt%20%2C%20-le%20%2F%20-ge%0A%0A%24FirstName%20%3D%20'Trevor'%0A%24FirstName%20-like%20'T*'%0A%24true%3B%20%24false%20%23bool%20true%2Ffalse%0A%0A%23%20ternary%20operator%0A%24FoodToEat%20%3D%20%24BaconIsYummy%20%3F%20'bacon'%20%3A%20'beets'%0A%0A%23%20-notin%20or%20-in%0A'Celery'%20-in%20%40('Bacon'%2C%20'Sausage'%2C%20'Steak')%0A%0A%23%20output%3A%20True%0A5%20-is%20%5Bint32%5D%0A%0A%23%20regex%20match%2C%20array%20can%20be%20use%0A'Trevor'%20-match%20'%5ET%5Cw*'%0A%0A%23%20Find%20multiple%20matches.%0A%24regex%20%3D%20%5Bregex%5D'(%5Cw*)'%0A%24regex.Matches('this%20is%20test').Value%0A%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-40",
      "sectionId": "s3",
      "title": "Structure%20-%20I%2FO%20operation",
      "body": "%60%60%60powershell%0A%22This%20displays%20a%20string%22%0A%0AWrite-Host%20%22color%22%20-ForegroundColor%20Red%0A%0A%24age%20%3D%20Read-host%20%22Enter%20age%22%0A%0A%24pwd%20%3D%20Read-host%20%22password%22%20-asSecureString%0A%0AClear-Host%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-41",
      "sectionId": "s3",
      "title": "Flow%20Controls",
      "body": "%60%60%60powershell%0AIF(%3C%23Condition%23%3E)%7B%0A%3C%23Commands%23%3E%7DELSEIF()%7B%7DELSE%7B%7D%0A%0ASwitch(%24var)%7B%0A%09%22val1%22%7B%3C%23Commands%23%3E%3B%20break%7D%0A%20%20%20%20%22val2%22%7B%3C%23Commands%23%3E%3B%20break%7D%0A%7D%0A%0AFor(%24ct%3D0%3B%24ct%20-le%203%3B%24ct%2B%2B)%7B%7D%0A%0AForEach(%24var%20in%20%24arr)%7B%7D%0A%0Awhile(%24var%20-ne%200)%7B%7D%0A%0ADo%7B%7DWhile()%0A%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-42",
      "sectionId": "s3",
      "title": "Function%20%2F%20Modules%20-%20Example%201",
      "body": "%60%60%60powershell%0Afunction%20funcname%7B%0A%0A%20%20%20%20%5BCmdletBinding()%5D%0A%09param(%0A%09%09%5BParameter(Mandatory)%5D%0A%09%09%5BString%5D%24user%0A%09)%0A%09Write-Host%20%22welcome%20%22%20%24user%0A%20%20%20%20return%20%22value%22%0A%7D%0A%24var%20%3D%20funcname%20-user%20pcb%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-43",
      "sectionId": "s3",
      "title": "Example 2",
      "body": "```powershell\nfunction Get-EvenNumbers {\n    [CmdletBinding()]\n    param (\n        [Parameter(ValueFromPipeline = $true)]\n        [int] $Number\n    )\n    begin {<#command#>}\n    process {\n        if ($Number % 2 -eq 0) {\n            Write-Output $Number\n        }\n    }\n    end {<#command#>}\n}\n1..10 | Get-EvenNumbers\n\n```"
    },
    {
      "id": "s3-44",
      "sectionId": "s3",
      "title": "Modules",
      "body": "```powershell\n# PowerShell looks module in the path\n$env:PSModulePath\n\n# lists all modules installed on system\nGet-Module -ListAvailable\n# modules imported into current session\nGet-Module\n\nImport-Module <moduleName>\nRemove-Module <moduleName>\n\nFind-Module -Tag cloud\nFind-Module -Name ps*\n\n# Create an in-memory PowerShell module\nNew-Module -Name trevor -ScriptBlock {\n  function Add($a,$b) { $a + $b } }\n\n\n```"
    },
    {
      "id": "s3-45",
      "sectionId": "s3",
      "title": "Tips",
      "body": "• In most of the languages, escape character is backslash **\\\\** whereas in PowerShell it is backtick **`**\n\n```powershell\n\n```"
    },
    {
      "id": "s4-47",
      "sectionId": "s4",
      "title": "Also see",
      "body": "• [Microsoft PowerShell](https://learn.microsoft.com/en-us/powershell/scripting/samples/sample-scripts-for-administration?view=powershell-7.3)"
    },
    {
      "id": "s4-48",
      "sectionId": "s4",
      "title": "Also see",
      "body": "_(learn.microsoft.com)_"
    }
  ],
  "source": {
    "repo": "https://github.com/Fechin/reference",
    "path": "source/_posts/powershell.md",
    "ref": "main",
    "url": "https://github.com/Fechin/reference/tree/main/source/_posts/powershell.md",
    "lang": "en",
    "mode": "local"
  }
}
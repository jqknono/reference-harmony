{
  "id": "powershell",
  "name": "PowerShell 备忘清单",
  "title": "PowerShell 用于自动化任务和配置管理的常用命令的备忘清单，可帮助系统管理员快速参考常用操作。",
  "icon": "https://raw.githubusercontent.com/jaywcjlove/reference/main/assets/powershell.svg",
  "sections": [
    {
      "id": "intro",
      "title": "简介",
      "startIndex": 0
    },
    {
      "id": "s1",
      "title": "常用操作",
      "startIndex": 1
    },
    {
      "id": "s2",
      "title": "系统管理",
      "startIndex": 38
    },
    {
      "id": "s3",
      "title": "脚本",
      "startIndex": 52
    },
    {
      "id": "s4",
      "title": "参考",
      "startIndex": 69
    }
  ],
  "cards": [
    {
      "id": "intro-0",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "PowerShell 用于自动化任务和配置管理的常用命令的备忘清单，可帮助系统管理员快速参考常用操作。"
    },
    {
      "id": "s1-1",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "text",
      "body": "**_PowerShell 的命令遵循动词-名词格式_** 一些常见的动词:"
    },
    {
      "id": "s1-2",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Get",
      "back": "用于检索信息"
    },
    {
      "id": "s1-3",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Set",
      "back": "用于配置或更改设置"
    },
    {
      "id": "s1-4",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "New",
      "back": "用于创建新对象实例"
    },
    {
      "id": "s1-5",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Remove",
      "back": "用于删除或移除项目"
    },
    {
      "id": "s1-6",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Invoke",
      "back": "用于执行特定的操作或动作"
    },
    {
      "id": "s1-7",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Start",
      "back": "用于启动进程或操作"
    },
    {
      "id": "s1-8",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Stop",
      "back": "用于停止或终止进程或操作"
    },
    {
      "id": "s1-9",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Enable",
      "back": "用于激活或启用功能"
    },
    {
      "id": "s1-10",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Disable",
      "back": "用于停用或禁用功能"
    },
    {
      "id": "s1-11",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Test",
      "back": "用于执行测试或检查"
    },
    {
      "id": "s1-12",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "qa",
      "front": "Update",
      "back": "用于更新或刷新数据或配置"
    },
    {
      "id": "s1-13",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "text",
      "body": "列出可用模块"
    },
    {
      "id": "s1-14",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Module --ListAvailable"
    },
    {
      "id": "s1-15",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "text",
      "body": "列出可用的 cmdlet 和函数"
    },
    {
      "id": "s1-16",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Command -Module ActiveDirectory"
    },
    {
      "id": "s1-17",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "text",
      "body": "列出别名及其对应的 cmdlet 名称"
    },
    {
      "id": "s1-18",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Alias | Select-Object Name, Definition"
    },
    {
      "id": "s1-19",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "text",
      "body": "获取帮助"
    },
    {
      "id": "s1-20",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Help <cmd>\nGet-Help <cmd> -Examples\nGet-Help -Name Get-Process -Parameter Id"
    },
    {
      "id": "s1-21",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "text",
      "body": "**Get-Member:** 显示对象的属性和方法"
    },
    {
      "id": "s1-22",
      "sectionId": "s1",
      "title": "辅助命令",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Process | Get-Member"
    },
    {
      "id": "s1-23",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "text",
      "body": "**Select-Object:** 选择对象的特定属性或自定义其显示"
    },
    {
      "id": "s1-24",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Process | Select-Object Name, CPU"
    },
    {
      "id": "s1-25",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "text",
      "body": "**Where-Object:** 根据指定条件过滤对象"
    },
    {
      "id": "s1-26",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Service | Where-Object { $PSItem.Status -eq 'Running' }\n#OR\nGet-Service | ? { $_.Status -eq 'Running' }"
    },
    {
      "id": "s1-27",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "text",
      "body": "**Measure-Object:** 计算对象属性的统计信息，如总和、平均值和计数"
    },
    {
      "id": "s1-28",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Process | Measure-Object -Property WorkingSet -Sum"
    },
    {
      "id": "s1-29",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "text",
      "body": "**ForEach-Object:** 对集合中的每个对象执行操作（注意：以下命令将为当前目录中的文件/文件夹添加前缀）"
    },
    {
      "id": "s1-30",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-ChildItem | ForEach-Object { Rename-Item $_ -NewName \"Prefix_$_\" }"
    },
    {
      "id": "s1-31",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "text",
      "body": "**Sort-Object:** 按指定属性对对象进行排序"
    },
    {
      "id": "s1-32",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-ChildItem | Sort-Object Length -Descending"
    },
    {
      "id": "s1-33",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "text",
      "body": "**Format-Table:** 将输出格式化为带有指定列的表格"
    },
    {
      "id": "s1-34",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Service | Format-Table -AutoSize  # ft alias"
    },
    {
      "id": "s1-35",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "text",
      "body": "**Format-List:** 将输出格式化为属性和值的列表"
    },
    {
      "id": "s1-36",
      "sectionId": "s1",
      "title": "对象操作",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Process | Format-List -Property Name, CPU  # fl alias"
    },
    {
      "id": "s1-37",
      "sectionId": "s1",
      "title": "文件系统",
      "kind": "code",
      "lang": "PowerShell",
      "code": "New-Item -path file.txt -type 'file' -value 'contents'\nNew-Item -path file.txt -type 'dir'\nCopy-Item <src> -destination <dest>\nMove-Item -path  <src> -destination <dest>\nRemove-Item <file>\nTest-Path <path>\nRename-Item -path <path> -newname <newname>\n\n# using .NET Base Class Library\n[System.IO.File]::WriteAllText('test.txt', '')\n[System.IO.File]::Delete('test.txt')\n\nGet-Content -Path \"test.txt\"\nGet-Process | Out-File -FilePath \"processes.txt\"# 输出到文件\nGet-Process | Export-Csv -Path \"processes.csv\"  # 输出到 CSV\n$data = Import-Csv -Path \"data.csv\"             # 从 CSV 导入"
    },
    {
      "id": "s2-38",
      "sectionId": "s2",
      "title": "获取信息",
      "kind": "code",
      "lang": "PowerShell",
      "code": "# 获取 BIOS 信息\nGet-CimInstance -ClassName Win32_BIOS\n# 获取本地连接的物理磁盘设备信息\nGet-CimInstance -ClassName Win32_DiskDrive\n# 获取安装的物理内存（RAM）信息\nGet-CimInstance -ClassName Win32_PhysicalMemory\n# 获取安装的网络适配器（物理 + 虚拟）信息\nGet-CimInstance -ClassName Win32_NetworkAdapter\n# 获取安装的图形/显卡（GPU）信息\nGet-CimInstance -ClassName Win32_VideoController"
    },
    {
      "id": "s2-39",
      "sectionId": "s2",
      "title": "命名空间 & 类",
      "kind": "text",
      "body": "列出所有类名"
    },
    {
      "id": "s2-40",
      "sectionId": "s2",
      "title": "命名空间 & 类",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-CimClass | Select-Object -ExpandProperty CimClassName"
    },
    {
      "id": "s2-41",
      "sectionId": "s2",
      "title": "命名空间 & 类",
      "kind": "text",
      "body": "探索 root\\cimv2 命名空间中的各种 WMI 类"
    },
    {
      "id": "s2-42",
      "sectionId": "s2",
      "title": "命名空间 & 类",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-CimClass -Namespace root\\cimv2"
    },
    {
      "id": "s2-43",
      "sectionId": "s2",
      "title": "命名空间 & 类",
      "kind": "text",
      "body": "探索 root\\cimv2 命名空间下的子 WMI 命名空间"
    },
    {
      "id": "s2-44",
      "sectionId": "s2",
      "title": "命名空间 & 类",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-CimInstance -Namespace root -ClassName __NAMESPACE"
    },
    {
      "id": "s2-45",
      "sectionId": "s2",
      "title": "网络管理",
      "kind": "code",
      "lang": "PowerShell",
      "code": "# 测试与远程主机的网络连接\nTest-Connection -ComputerName google.com\n\n# 获取网络适配器信息\nGet-NetAdapter\n\n# 获取 IP 地址信息\nGet-NetIPAddress\n\n# 获取路由表信息\nGet-NetRoute\n\n# 测试远程主机上的端口是否开放\nTest-NetConnection google.com -Port 80"
    },
    {
      "id": "s2-46",
      "sectionId": "s2",
      "title": "用户和组管理",
      "kind": "code",
      "lang": "PowerShell",
      "code": "# 获取本地用户账户信息\nGet-LocalUser\n\n# 创建新的本地用户账户\nNew-LocalUser -Name NewUser -Password (ConvertTo-SecureString \"Password123\" -AsPlainText -Force)\n\n# 删除本地用户账户\nRemove-LocalUser -Name UserToRemove\n\n# 获取本地组信息\nGet-LocalGroup\n\n# 将成员添加到本地组\nAdd-LocalGroupMember -Group Administrators -Member UserToAdd"
    },
    {
      "id": "s2-47",
      "sectionId": "s2",
      "title": "安全性和权限",
      "kind": "text",
      "body": "获取文件/目录的访问控制列表"
    },
    {
      "id": "s2-48",
      "sectionId": "s2",
      "title": "安全性和权限",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Get-Acl C:\\Path\\To\\File.txt"
    },
    {
      "id": "s2-49",
      "sectionId": "s2",
      "title": "安全性和权限",
      "kind": "text",
      "body": "设置文件/目录的访问控制列表"
    },
    {
      "id": "s2-50",
      "sectionId": "s2",
      "title": "安全性和权限",
      "kind": "code",
      "lang": "PowerShell",
      "code": "Set-Acl -Path C:\\Path\\To\\File.txt -AclObject $aclObject"
    },
    {
      "id": "s2-51",
      "sectionId": "s2",
      "title": "注册表管理",
      "kind": "code",
      "lang": "PowerShell",
      "code": "# 获取注册表键值\nGet-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*\" | Select DisplayName, DisplayVersion\n\n# 设置注册表键值\nSet-ItemProperty -Path \"HKLM:\\Software\\MyApp\" -Name \"SettingName\" -Value \"NewValue\"\n\n# 创建新的注册表键值\nNew-ItemProperty -Path \"HKCU:\\Software\\MyApp\" -Name \"NewSetting\" -Value \"NewValue\" -PropertyType String\n\n# 删除注册表键值\nRemove-ItemProperty -Path \"HKCU:\\Software\\MyApp\" -Name \"SettingToRemove\"\n\n# 检查注册表键是否存在\nTest-Path \"HKLM:\\Software\\MyApp\""
    },
    {
      "id": "s3-52",
      "sectionId": "s3",
      "title": "变量",
      "kind": "text",
      "body": "初始化变量，指定或不指定类型："
    },
    {
      "id": "s3-53",
      "sectionId": "s3",
      "title": "变量",
      "kind": "code",
      "lang": "PowerShell",
      "code": "$var = 0\n[int] $var = 'Trevor'         # (抛出异常)\n[string] $var = 'Trevor'      # (不会抛出异常)\n$var.GetType()\n\n# 多重赋值\n$a,$b,$c = 'a','b','c'\n\n# 创建数组\n$arrayvar = @('va1','va2')\n\n# 创建字典\n$dict = @{k1 = 'test'; k2 = 'best'}"
    },
    {
      "id": "s3-54",
      "sectionId": "s3",
      "title": "变量",
      "kind": "text",
      "body": "变量命令"
    },
    {
      "id": "s3-55",
      "sectionId": "s3",
      "title": "变量",
      "kind": "code",
      "lang": "PowerShell",
      "code": "New-Variable -Name FirstName -Value Trevor\nNew-Variable FirstName -Value Trevor -Option <ReadOnly/Constant>\n\nGet-Variable\nGet-Variable | ? { $PSItem.Options -contains 'constant' }\nGet-Variable | ? { $PSItem.Options -contains 'readonly' }\n\nRemove-Variable -Name firstname\n# 删除只读变量\nRemove-Variable -Name firstname -Force"
    },
    {
      "id": "s3-56",
      "sectionId": "s3",
      "title": "变量",
      "kind": "text",
      "body": "变量类型：int32, int64, string, bool"
    },
    {
      "id": "s3-57",
      "sectionId": "s3",
      "title": "运算符",
      "kind": "code",
      "lang": "PowerShell",
      "code": "# 运算符\n# (a <op> b)\n\n= , += / -= , ++ / --\n-eq / -ne , -lt / -gt , -le / -ge\n\n$FirstName = 'Trevor'\n$FirstName -like 'T*'\n$true; $false # 布尔值 true/false\n\n# 三元运算符\n$FoodToEat = $BaconIsYummy ? 'bacon' : 'beets'\n\n# -notin 或 -in\n'Celery' -in @('Bacon', 'Sausage', 'Steak')\n\n# 输出: True\n5 -is [int32]\n\n# 正则表达式匹配，可以使用数组\n'Trevor' -match '^T\\w*'\n\n# 查找多个匹配项\n$regex = [regex]'(\\w*)'\n$regex.Matches('this is test').Value"
    },
    {
      "id": "s3-58",
      "sectionId": "s3",
      "title": "Structure",
      "kind": "text",
      "body": "#### 输入输出操作"
    },
    {
      "id": "s3-59",
      "sectionId": "s3",
      "title": "Structure",
      "kind": "code",
      "lang": "PowerShell",
      "code": "\"This displays a string\"\n\nWrite-Host \"color\" -ForegroundColor Red\n\n$age = Read-host \"Enter age\"\n\n$pwd = Read-host \"password\" -asSecureString\n\nClear-Host"
    },
    {
      "id": "s3-60",
      "sectionId": "s3",
      "title": "Structure",
      "kind": "text",
      "body": "#### 流控制"
    },
    {
      "id": "s3-61",
      "sectionId": "s3",
      "title": "Structure",
      "kind": "code",
      "lang": "PowerShell",
      "code": "IF(<#Condition#>){\n<#Commands#>}ELSEIF(){}ELSE{}\n\nSwitch($var){\n  \"val1\"{<#Commands#>; break}\n    \"val2\"{<#Commands#>; break}\n}\n\nFor($ct=0;$ct -le 3;$ct++){}\n\nForEach($var in $arr){}\n\nwhile($var -ne 0){}\n\nDo{}While()"
    },
    {
      "id": "s3-62",
      "sectionId": "s3",
      "title": "函数 / 模块",
      "kind": "text",
      "body": "#### 示例 1"
    },
    {
      "id": "s3-63",
      "sectionId": "s3",
      "title": "函数 / 模块",
      "kind": "code",
      "lang": "PowerShell",
      "code": "function funcname{\n\n    [CmdletBinding()]\n  param(\n    [Parameter(Mandatory)]\n    [String]$user\n  )\n  Write-Host \"welcome \" $user\n    return \"value\"\n}\n$var = funcname -user pcb"
    },
    {
      "id": "s3-64",
      "sectionId": "s3",
      "title": "函数 / 模块",
      "kind": "text",
      "body": "#### 示例 2"
    },
    {
      "id": "s3-65",
      "sectionId": "s3",
      "title": "函数 / 模块",
      "kind": "code",
      "lang": "PowerShell",
      "code": "function Get-EvenNumbers {\n    [CmdletBinding()]\n    param (\n        [Parameter(ValueFromPipeline = $true)]\n        [int] $Number\n    )\n    begin {<#command#>}\n    process {\n        if ($Number % 2 -eq 0) {\n            Write-Output $Number\n        }\n    }\n    end {<#command#>}\n}\n1..10 | Get-EvenNumbers"
    },
    {
      "id": "s3-66",
      "sectionId": "s3",
      "title": "函数 / 模块",
      "kind": "text",
      "body": "#### 模块"
    },
    {
      "id": "s3-67",
      "sectionId": "s3",
      "title": "函数 / 模块",
      "kind": "code",
      "lang": "PowerShell",
      "code": "# PowerShell 在路径中查找模块\n$env:PSModulePath\n\n# 列出系统上安装的所有模块\nGet-Module -ListAvailable\n# 列出当前会话中导入的模块\nGet-Module\n\nImport-Module <moduleName>\nRemove-Module <moduleName>\n\nFind-Module -Tag cloud\nFind-Module -Name ps*\n\n# 创建一个内存中的 PowerShell 模块\nNew-Module -Name trevor -ScriptBlock {\n  function Add($a,$b) { $a + $b } }"
    },
    {
      "id": "s3-68",
      "sectionId": "s3",
      "title": "注意",
      "kind": "text",
      "body": "• 在大多数语言中，转义字符是反斜杠 **\\\\**，而在 PowerShell 中是反引号 **`**"
    },
    {
      "id": "s4-69",
      "sectionId": "s4",
      "title": "参考",
      "kind": "text",
      "body": "• [Microsoft PowerShell](https://learn.microsoft.com/en-us/powershell/scripting/samples/sample-scripts-for-administration?view=powershell-7.3) _(learn.microsoft.com)_\n• [cheatsheets](https://cheatsheets.zip/powershell)"
    }
  ],
  "source": {
    "repo": "https://github.com/jaywcjlove/reference",
    "path": "docs/powershell.md",
    "ref": "main",
    "url": "https://github.com/jaywcjlove/reference/tree/main/docs/powershell.md",
    "lang": "zh",
    "mode": "local"
  }
}
{
  "id": "powershell",
  "name": "PowerShell 备忘清单",
  "title": "PowerShell 用于自动化任务和配置管理的常用命令的备忘清单，可帮助系统管理员快速参考常用操作。",
  "icon": "https://raw.githubusercontent.com/jaywcjlove/reference/main/assets/powershell.svg",
  "sections": [
    {
      "id": "intro",
      "title": "简介",
      "startIndex": 0
    },
    {
      "id": "s1",
      "title": "常用操作",
      "startIndex": 1
    },
    {
      "id": "s2",
      "title": "系统管理",
      "startIndex": 28
    },
    {
      "id": "s3",
      "title": "脚本",
      "startIndex": 42
    },
    {
      "id": "s4",
      "title": "参考",
      "startIndex": 54
    }
  ],
  "cards": [
    {
      "id": "intro-0",
      "sectionId": "intro",
      "title": "简介",
      "body": "PowerShell 用于自动化任务和配置管理的常用命令的备忘清单，可帮助系统管理员快速参考常用操作。"
    },
    {
      "id": "s1-1",
      "sectionId": "s1",
      "title": "辅助命令",
      "body": "**_PowerShell 的命令遵循动词-名词格式_** 一些常见的动词:\n\n| 动词    | 描述                     |\n| ------- | ------------------------ |\n| Get     | 用于检索信息             |\n| Set     | 用于配置或更改设置       |\n| New     | 用于创建新对象实例       |\n| Remove  | 用于删除或移除项目       |\n| Invoke  | 用于执行特定的操作或动作 |\n| Start   | 用于启动进程或操作       |\n| Stop    | 用于停止或终止进程或操作 |\n| Enable  | 用于激活或启用功能       |\n| Disable | 用于停用或禁用功能       |\n| Test    | 用于执行测试或检查       |\n| Update  | 用于更新或刷新数据或配置 |\n\n列出可用模块\n\n```PowerShell\nGet-Module --ListAvailable\n```\n\n列出可用的 cmdlet 和函数\n\n```PowerShell\nGet-Command -Module ActiveDirectory\n```\n\n列出别名及其对应的 cmdlet 名称\n\n```PowerShell\nGet-Alias | Select-Object Name, Definition\n```\n\n获取帮助\n\n```PowerShell\nGet-Help <cmd>\nGet-Help <cmd> -Examples\nGet-Help -Name Get-Process -Parameter Id\n```\n\n**Get-Member:** 显示对象的属性和方法\n\n```PowerShell\nGet-Process | Get-Member\n```"
    },
    {
      "id": "s1-13",
      "sectionId": "s1",
      "title": "%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C",
      "body": "**Select-Object%3A**%20%E9%80%89%E6%8B%A9%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%89%B9%E5%AE%9A%E5%B1%9E%E6%80%A7%E6%88%96%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%B6%E6%98%BE%E7%A4%BA%0A%0A%60%60%60PowerShell%0AGet-Process%20%7C%20Select-Object%20Name%2C%20CPU%0A%60%60%60%0A%0A**Where-Object%3A**%20%E6%A0%B9%E6%8D%AE%E6%8C%87%E5%AE%9A%E6%9D%A1%E4%BB%B6%E8%BF%87%E6%BB%A4%E5%AF%B9%E8%B1%A1%0A%0A%60%60%60PowerShell%0AGet-Service%20%7C%20Where-Object%20%7B%20%24PSItem.Status%20-eq%20'Running'%20%7D%0A%23OR%0AGet-Service%20%7C%20%3F%20%7B%20%24_.Status%20-eq%20'Running'%20%7D%0A%60%60%60%0A%0A**Measure-Object%3A**%20%E8%AE%A1%E7%AE%97%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E7%9A%84%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%A6%82%E6%80%BB%E5%92%8C%E3%80%81%E5%B9%B3%E5%9D%87%E5%80%BC%E5%92%8C%E8%AE%A1%E6%95%B0%0A%0A%60%60%60PowerShell%0AGet-Process%20%7C%20Measure-Object%20-Property%20WorkingSet%20-Sum%0A%60%60%60%0A%0A**ForEach-Object%3A**%20%E5%AF%B9%E9%9B%86%E5%90%88%E4%B8%AD%E7%9A%84%E6%AF%8F%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%89%A7%E8%A1%8C%E6%93%8D%E4%BD%9C%EF%BC%88%E6%B3%A8%E6%84%8F%EF%BC%9A%E4%BB%A5%E4%B8%8B%E5%91%BD%E4%BB%A4%E5%B0%86%E4%B8%BA%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%2F%E6%96%87%E4%BB%B6%E5%A4%B9%E6%B7%BB%E5%8A%A0%E5%89%8D%E7%BC%80%EF%BC%89%0A%0A%60%60%60PowerShell%0AGet-ChildItem%20%7C%20ForEach-Object%20%7B%20Rename-Item%20%24_%20-NewName%20%22Prefix_%24_%22%20%7D%0A%60%60%60%0A%0A**Sort-Object%3A**%20%E6%8C%89%E6%8C%87%E5%AE%9A%E5%B1%9E%E6%80%A7%E5%AF%B9%E5%AF%B9%E8%B1%A1%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F%0A%0A%60%60%60PowerShell%0AGet-ChildItem%20%7C%20Sort-Object%20Length%20-Descending%0A%60%60%60%0A%0A**Format-Table%3A**%20%E5%B0%86%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%E5%8C%96%E4%B8%BA%E5%B8%A6%E6%9C%89%E6%8C%87%E5%AE%9A%E5%88%97%E7%9A%84%E8%A1%A8%E6%A0%BC%0A%0A%60%60%60PowerShell%0AGet-Service%20%7C%20Format-Table%20-AutoSize%20%20%23%20ft%20alias%0A%60%60%60%0A%0A**Format-List%3A**%20%E5%B0%86%E8%BE%93%E5%87%BA%E6%A0%BC%E5%BC%8F%E5%8C%96%E4%B8%BA%E5%B1%9E%E6%80%A7%E5%92%8C%E5%80%BC%E7%9A%84%E5%88%97%E8%A1%A8%0A%0A%60%60%60PowerShell%0AGet-Process%20%7C%20Format-List%20-Property%20Name%2C%20CPU%20%20%23%20fl%20alias%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s1-27",
      "sectionId": "s1",
      "title": "%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F",
      "body": "%60%60%60PowerShell%0ANew-Item%20-path%20file.txt%20-type%20'file'%20-value%20'contents'%0ANew-Item%20-path%20file.txt%20-type%20'dir'%0ACopy-Item%20%3Csrc%3E%20-destination%20%3Cdest%3E%0AMove-Item%20-path%20%20%3Csrc%3E%20-destination%20%3Cdest%3E%0ARemove-Item%20%3Cfile%3E%0ATest-Path%20%3Cpath%3E%0ARename-Item%20-path%20%3Cpath%3E%20-newname%20%3Cnewname%3E%0A%0A%23%20using%20.NET%20Base%20Class%20Library%0A%5BSystem.IO.File%5D%3A%3AWriteAllText('test.txt'%2C%20'')%0A%5BSystem.IO.File%5D%3A%3ADelete('test.txt')%0A%0AGet-Content%20-Path%20%22test.txt%22%0AGet-Process%20%7C%20Out-File%20-FilePath%20%22processes.txt%22%23%20%E8%BE%93%E5%87%BA%E5%88%B0%E6%96%87%E4%BB%B6%0AGet-Process%20%7C%20Export-Csv%20-Path%20%22processes.csv%22%20%20%23%20%E8%BE%93%E5%87%BA%E5%88%B0%20CSV%0A%24data%20%3D%20Import-Csv%20-Path%20%22data.csv%22%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20%E4%BB%8E%20CSV%20%E5%AF%BC%E5%85%A5%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s2-28",
      "sectionId": "s2",
      "title": "获取信息",
      "body": "```PowerShell\n# 获取 BIOS 信息\nGet-CimInstance -ClassName Win32_BIOS\n# 获取本地连接的物理磁盘设备信息\nGet-CimInstance -ClassName Win32_DiskDrive\n# 获取安装的物理内存（RAM）信息\nGet-CimInstance -ClassName Win32_PhysicalMemory\n# 获取安装的网络适配器（物理 + 虚拟）信息\nGet-CimInstance -ClassName Win32_NetworkAdapter\n# 获取安装的图形/显卡（GPU）信息\nGet-CimInstance -ClassName Win32_VideoController\n```"
    },
    {
      "id": "s2-29",
      "sectionId": "s2",
      "title": "命名空间 & 类",
      "body": "列出所有类名\n\n```PowerShell\nGet-CimClass | Select-Object -ExpandProperty CimClassName\n```\n\n探索 root\\cimv2 命名空间中的各种 WMI 类\n\n```PowerShell\nGet-CimClass -Namespace root\\cimv2\n```\n\n探索 root\\cimv2 命名空间下的子 WMI 命名空间\n\n```PowerShell\nGet-CimInstance -Namespace root -ClassName __NAMESPACE\n```"
    },
    {
      "id": "s2-35",
      "sectionId": "s2",
      "title": "网络管理",
      "body": "```PowerShell\n# 测试与远程主机的网络连接\nTest-Connection -ComputerName google.com\n\n# 获取网络适配器信息\nGet-NetAdapter\n\n# 获取 IP 地址信息\nGet-NetIPAddress\n\n# 获取路由表信息\nGet-NetRoute\n\n# 测试远程主机上的端口是否开放\nTest-NetConnection google.com -Port 80\n```"
    },
    {
      "id": "s2-36",
      "sectionId": "s2",
      "title": "%E7%94%A8%E6%88%B7%E5%92%8C%E7%BB%84%E7%AE%A1%E7%90%86",
      "body": "%60%60%60PowerShell%0A%23%20%E8%8E%B7%E5%8F%96%E6%9C%AC%E5%9C%B0%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E4%BF%A1%E6%81%AF%0AGet-LocalUser%0A%0A%23%20%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E6%9C%AC%E5%9C%B0%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%0ANew-LocalUser%20-Name%20NewUser%20-Password%20(ConvertTo-SecureString%20%22Password123%22%20-AsPlainText%20-Force)%0A%0A%23%20%E5%88%A0%E9%99%A4%E6%9C%AC%E5%9C%B0%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%0ARemove-LocalUser%20-Name%20UserToRemove%0A%0A%23%20%E8%8E%B7%E5%8F%96%E6%9C%AC%E5%9C%B0%E7%BB%84%E4%BF%A1%E6%81%AF%0AGet-LocalGroup%0A%0A%23%20%E5%B0%86%E6%88%90%E5%91%98%E6%B7%BB%E5%8A%A0%E5%88%B0%E6%9C%AC%E5%9C%B0%E7%BB%84%0AAdd-LocalGroupMember%20-Group%20Administrators%20-Member%20UserToAdd%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s2-37",
      "sectionId": "s2",
      "title": "安全性和权限",
      "body": "获取文件/目录的访问控制列表\n\n```PowerShell\nGet-Acl C:\\Path\\To\\File.txt\n```\n\n设置文件/目录的访问控制列表\n\n```PowerShell\nSet-Acl -Path C:\\Path\\To\\File.txt -AclObject $aclObject\n```"
    },
    {
      "id": "s2-41",
      "sectionId": "s2",
      "title": "%E6%B3%A8%E5%86%8C%E8%A1%A8%E7%AE%A1%E7%90%86",
      "body": "%60%60%60PowerShell%0A%23%20%E8%8E%B7%E5%8F%96%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%94%AE%E5%80%BC%0AGet-ItemProperty%20-Path%20%22HKLM%3A%5CSoftware%5CMicrosoft%5CWindows%5CCurrentVersion%5CUninstall%5C*%22%20%7C%20Select%20DisplayName%2C%20DisplayVersion%0A%0A%23%20%E8%AE%BE%E7%BD%AE%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%94%AE%E5%80%BC%0ASet-ItemProperty%20-Path%20%22HKLM%3A%5CSoftware%5CMyApp%22%20-Name%20%22SettingName%22%20-Value%20%22NewValue%22%0A%0A%23%20%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%94%AE%E5%80%BC%0ANew-ItemProperty%20-Path%20%22HKCU%3A%5CSoftware%5CMyApp%22%20-Name%20%22NewSetting%22%20-Value%20%22NewValue%22%20-PropertyType%20String%0A%0A%23%20%E5%88%A0%E9%99%A4%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%94%AE%E5%80%BC%0ARemove-ItemProperty%20-Path%20%22HKCU%3A%5CSoftware%5CMyApp%22%20-Name%20%22SettingToRemove%22%0A%0A%23%20%E6%A3%80%E6%9F%A5%E6%B3%A8%E5%86%8C%E8%A1%A8%E9%94%AE%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%0ATest-Path%20%22HKLM%3A%5CSoftware%5CMyApp%22%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-42",
      "sectionId": "s3",
      "title": "%E5%8F%98%E9%87%8F",
      "body": "%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%98%E9%87%8F%EF%BC%8C%E6%8C%87%E5%AE%9A%E6%88%96%E4%B8%8D%E6%8C%87%E5%AE%9A%E7%B1%BB%E5%9E%8B%EF%BC%9A%0A%0A%60%60%60PowerShell%0A%24var%20%3D%200%0A%5Bint%5D%20%24var%20%3D%20'Trevor'%20%20%20%20%20%20%20%20%20%23%20(%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8)%0A%5Bstring%5D%20%24var%20%3D%20'Trevor'%20%20%20%20%20%20%23%20(%E4%B8%8D%E4%BC%9A%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8)%0A%24var.GetType()%0A%0A%23%20%E5%A4%9A%E9%87%8D%E8%B5%8B%E5%80%BC%0A%24a%2C%24b%2C%24c%20%3D%20'a'%2C'b'%2C'c'%0A%0A%23%20%E5%88%9B%E5%BB%BA%E6%95%B0%E7%BB%84%0A%24arrayvar%20%3D%20%40('va1'%2C'va2')%0A%0A%23%20%E5%88%9B%E5%BB%BA%E5%AD%97%E5%85%B8%0A%24dict%20%3D%20%40%7Bk1%20%3D%20'test'%3B%20k2%20%3D%20'best'%7D%0A%60%60%60%0A%0A%E5%8F%98%E9%87%8F%E5%91%BD%E4%BB%A4%0A%0A%60%60%60PowerShell%0ANew-Variable%20-Name%20FirstName%20-Value%20Trevor%0ANew-Variable%20FirstName%20-Value%20Trevor%20-Option%20%3CReadOnly%2FConstant%3E%0A%0AGet-Variable%0AGet-Variable%20%7C%20%3F%20%7B%20%24PSItem.Options%20-contains%20'constant'%20%7D%0AGet-Variable%20%7C%20%3F%20%7B%20%24PSItem.Options%20-contains%20'readonly'%20%7D%0A%0ARemove-Variable%20-Name%20firstname%0A%23%20%E5%88%A0%E9%99%A4%E5%8F%AA%E8%AF%BB%E5%8F%98%E9%87%8F%0ARemove-Variable%20-Name%20firstname%20-Force%0A%60%60%60%0A%0A%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%EF%BC%9Aint32%2C%20int64%2C%20string%2C%20bool",
      "encoded": true
    },
    {
      "id": "s3-47",
      "sectionId": "s3",
      "title": "%E8%BF%90%E7%AE%97%E7%AC%A6",
      "body": "%60%60%60PowerShell%0A%23%20%E8%BF%90%E7%AE%97%E7%AC%A6%0A%23%20(a%20%3Cop%3E%20b)%0A%0A%3D%20%2C%20%2B%3D%20%2F%20-%3D%20%2C%20%2B%2B%20%2F%20--%0A-eq%20%2F%20-ne%20%2C%20-lt%20%2F%20-gt%20%2C%20-le%20%2F%20-ge%0A%0A%24FirstName%20%3D%20'Trevor'%0A%24FirstName%20-like%20'T*'%0A%24true%3B%20%24false%20%23%20%E5%B8%83%E5%B0%94%E5%80%BC%20true%2Ffalse%0A%0A%23%20%E4%B8%89%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6%0A%24FoodToEat%20%3D%20%24BaconIsYummy%20%3F%20'bacon'%20%3A%20'beets'%0A%0A%23%20-notin%20%E6%88%96%20-in%0A'Celery'%20-in%20%40('Bacon'%2C%20'Sausage'%2C%20'Steak')%0A%0A%23%20%E8%BE%93%E5%87%BA%3A%20True%0A5%20-is%20%5Bint32%5D%0A%0A%23%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%B9%E9%85%8D%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E6%95%B0%E7%BB%84%0A'Trevor'%20-match%20'%5ET%5Cw*'%0A%0A%23%20%E6%9F%A5%E6%89%BE%E5%A4%9A%E4%B8%AA%E5%8C%B9%E9%85%8D%E9%A1%B9%0A%24regex%20%3D%20%5Bregex%5D'(%5Cw*)'%0A%24regex.Matches('this%20is%20test').Value%0A%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-48",
      "sectionId": "s3",
      "title": "Structure%20-%20%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%93%8D%E4%BD%9C",
      "body": "%60%60%60PowerShell%0A%22This%20displays%20a%20string%22%0A%0AWrite-Host%20%22color%22%20-ForegroundColor%20Red%0A%0A%24age%20%3D%20Read-host%20%22Enter%20age%22%0A%0A%24pwd%20%3D%20Read-host%20%22password%22%20-asSecureString%0A%0AClear-Host%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-49",
      "sectionId": "s3",
      "title": "%E6%B5%81%E6%8E%A7%E5%88%B6",
      "body": "%60%60%60PowerShell%0AIF(%3C%23Condition%23%3E)%7B%0A%3C%23Commands%23%3E%7DELSEIF()%7B%7DELSE%7B%7D%0A%0ASwitch(%24var)%7B%0A%20%20%22val1%22%7B%3C%23Commands%23%3E%3B%20break%7D%0A%20%20%20%20%22val2%22%7B%3C%23Commands%23%3E%3B%20break%7D%0A%7D%0A%0AFor(%24ct%3D0%3B%24ct%20-le%203%3B%24ct%2B%2B)%7B%7D%0A%0AForEach(%24var%20in%20%24arr)%7B%7D%0A%0Awhile(%24var%20-ne%200)%7B%7D%0A%0ADo%7B%7DWhile()%0A%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-50",
      "sectionId": "s3",
      "title": "%E5%87%BD%E6%95%B0%20%2F%20%E6%A8%A1%E5%9D%97%20-%20%E7%A4%BA%E4%BE%8B%201",
      "body": "%60%60%60PowerShell%0Afunction%20funcname%7B%0A%0A%20%20%20%20%5BCmdletBinding()%5D%0A%20%20param(%0A%20%20%20%20%5BParameter(Mandatory)%5D%0A%20%20%20%20%5BString%5D%24user%0A%20%20)%0A%20%20Write-Host%20%22welcome%20%22%20%24user%0A%20%20%20%20return%20%22value%22%0A%7D%0A%24var%20%3D%20funcname%20-user%20pcb%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s3-51",
      "sectionId": "s3",
      "title": "示例 2",
      "body": "```PowerShell\nfunction Get-EvenNumbers {\n    [CmdletBinding()]\n    param (\n        [Parameter(ValueFromPipeline = $true)]\n        [int] $Number\n    )\n    begin {<#command#>}\n    process {\n        if ($Number % 2 -eq 0) {\n            Write-Output $Number\n        }\n    }\n    end {<#command#>}\n}\n1..10 | Get-EvenNumbers\n\n```"
    },
    {
      "id": "s3-52",
      "sectionId": "s3",
      "title": "模块",
      "body": "```PowerShell\n# PowerShell 在路径中查找模块\n$env:PSModulePath\n\n# 列出系统上安装的所有模块\nGet-Module -ListAvailable\n# 列出当前会话中导入的模块\nGet-Module\n\nImport-Module <moduleName>\nRemove-Module <moduleName>\n\nFind-Module -Tag cloud\nFind-Module -Name ps*\n\n# 创建一个内存中的 PowerShell 模块\nNew-Module -Name trevor -ScriptBlock {\n  function Add($a,$b) { $a + $b } }\n\n```"
    },
    {
      "id": "s3-53",
      "sectionId": "s3",
      "title": "注意",
      "body": "• 在大多数语言中，转义字符是反斜杠 **\\\\**，而在 PowerShell 中是反引号 **`**"
    },
    {
      "id": "s4-54",
      "sectionId": "s4",
      "title": "参考",
      "body": "• [Microsoft PowerShell](https://learn.microsoft.com/en-us/powershell/scripting/samples/sample-scripts-for-administration?view=powershell-7.3) _(learn.microsoft.com)_\n• [cheatsheets](https://cheatsheets.zip/powershell)"
    }
  ],
  "source": {
    "repo": "https://github.com/jaywcjlove/reference",
    "path": "docs/powershell.md",
    "ref": "main",
    "url": "https://github.com/jaywcjlove/reference/tree/main/docs/powershell.md",
    "lang": "zh",
    "mode": "local"
  }
}
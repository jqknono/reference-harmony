{
  "id": "taskset",
  "name": "Taskset 备忘清单",
  "title": "`Taskset` 命令用于设置或检索给定pid的运行进程的CPU相关性，或启动具有给定CPU相关性的新命令",
  "icon": "https://raw.githubusercontent.com/jaywcjlove/reference/main/assets/taskset.svg",
  "sections": [
    {
      "id": "intro",
      "title": "简介",
      "startIndex": 0
    },
    {
      "id": "s1",
      "title": "入门",
      "startIndex": 1
    },
    {
      "id": "s2",
      "title": "示例",
      "startIndex": 6
    },
    {
      "id": "s3",
      "title": "另见",
      "startIndex": 50
    }
  ],
  "cards": [
    {
      "id": "intro-0",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "`Taskset` 命令用于设置或检索给定pid的运行进程的CPU相关性，或启动具有给定CPU相关性的新命令"
    },
    {
      "id": "s1-1",
      "sectionId": "s1",
      "title": "使用",
      "kind": "text",
      "body": "默认行为是使用给定的关联掩码运行新命令"
    },
    {
      "id": "s1-2",
      "sectionId": "s1",
      "title": "",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset [mask] [command] [arguments]"
    },
    {
      "id": "s1-3",
      "sectionId": "s1",
      "title": "使用 #2",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -p [pid]\n\n$ taskset -p [mask] [pid]"
    },
    {
      "id": "s1-4",
      "sectionId": "s1",
      "title": "",
      "kind": "text",
      "body": "您还可以检索现有任务的CPU相关性"
    },
    {
      "id": "s1-5",
      "sectionId": "s1",
      "title": "常用选项",
      "kind": "text",
      "body": "命令 | 候补 | 含义\n---|---|---\n`-a`    | --all-tasks  | 设置或检索给定PID的所有任务（线程）的CPU相关性\n`-c`    | --cpu-list   | 将掩码解释为处理器的数字列表，而不是位掩码</br>数字用逗号分隔，可能包括范围。例如：`0,5,8-11`\n`-p`    | --pid        | 对现有PID进行操作，不要启动新任务\n`-h`    | --help       | 显示帮助文本并退出\n`-v`    | --version    | 打印版本并退出"
    },
    {
      "id": "s2-6",
      "sectionId": "s2",
      "title": "查看CPU相关性",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 29523\npid 29523's current affinity list: 0-15"
    },
    {
      "id": "s2-7",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "这意味着 PID `29523` 的进程在 CPU 范围 `[0,1,...,15]` 上处于活动状态，这意味着总共 `16`。"
    },
    {
      "id": "s2-8",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "**PID**：进程标识符 - 是赋予每个正在运行的进程的唯一数字标识符，您可以在 `top` 或 `htop` 工具中查看进程的PID"
    },
    {
      "id": "s2-9",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "_如果您运行上述命令但收到消息 `错误使用`，请尝试使用 PID = 1_"
    },
    {
      "id": "s2-10",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 1"
    },
    {
      "id": "s2-11",
      "sectionId": "s2",
      "title": "设置 CPU 相关性",
      "kind": "text",
      "body": "现在让我们尝试将进程设置到指定的CPU。 例如，我们有一个进程 PID = 14846"
    },
    {
      "id": "s2-12",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "我们先看一下该进程的CPU相关性列表："
    },
    {
      "id": "s2-13",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 14846\npid 14846's current affinity list: 0-15"
    },
    {
      "id": "s2-14",
      "sectionId": "s2",
      "title": "将 CPU 关联性更改为 1",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 1 14846\npid 14846's current affinity list: 0-15\npid 14846's new affinity list: 1"
    },
    {
      "id": "s2-15",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "正如我们所看到的，CPU 相关性发生了变化"
    },
    {
      "id": "s2-16",
      "sectionId": "s2",
      "title": "设置多个值的CPU 相关性",
      "kind": "text",
      "body": "这意味着新的CPU关联列表是`[0,1,2,3]`"
    },
    {
      "id": "s2-17",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 0-3 14846\npid 14846's current affinity list: 1\npid 14846's new affinity list: 0-3"
    },
    {
      "id": "s2-18",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "您可以使用以下命令设置单个CPU："
    },
    {
      "id": "s2-19",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 5,8,12 14846\npid 14846's current affinity list: 0-3\npid 14846's new affinity list: 5,8,12"
    },
    {
      "id": "s2-20",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "这意味着新的CPU关联列表是`[5,8,12]`"
    },
    {
      "id": "s2-21",
      "sectionId": "s2",
      "title": "将进程的CPU亲和性设置为特定的CPU核心",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -p <cpu_mask> <pid>"
    },
    {
      "id": "s2-22",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset -p 0x00000001 12345` 将进程ID为12345的进程的CPU亲和性设置为CPU核心 0。"
    },
    {
      "id": "s2-23",
      "sectionId": "s2",
      "title": "获取进程的CPU亲和性",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -p <pid>"
    },
    {
      "id": "s2-24",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset -p 12345` 将显示进程ID为12345的进程的CPU亲和性。"
    },
    {
      "id": "s2-25",
      "sectionId": "s2",
      "title": "启动一个新进程，并将其CPU亲和性设置为特定的CPU核心",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset <cpu_mask> <command>"
    },
    {
      "id": "s2-26",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset 0x00000001 ./my_program` 将以CPU核心 0 的亲和性运行 ./my_program。"
    },
    {
      "id": "s2-27",
      "sectionId": "s2",
      "title": "将已运行进程的CPU亲和性移动到特定的CPU核心",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -p -c <cpu_list> <pid>"
    },
    {
      "id": "s2-28",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset -p -c 0,1 12345` 将进程ID为12345的进程的CPU亲和性移动到CPU核心 0 和 1。"
    },
    {
      "id": "s2-29",
      "sectionId": "s2",
      "title": "指定进程只能在指定的CPU核心上运行（排他性）",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -p --exclusive <cpu_mask> <pid>"
    },
    {
      "id": "s2-30",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset -p --exclusive 0x00000001 12345` 将进程ID为12345的进程限制在CPU核心 0 上运行。"
    },
    {
      "id": "s2-31",
      "sectionId": "s2",
      "title": "将所有已运行进程的CPU亲和性设置为特定的CPU核心",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -a -p <cpu_mask>"
    },
    {
      "id": "s2-32",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset -a -p 0x00000001` 将所有进程的CPU亲和性设置为CPU核心 0。"
    },
    {
      "id": "s2-33",
      "sectionId": "s2",
      "title": "在启动新进程时设置CPU亲和性，并指定优先级",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -c <cpu_mask> nice -n <priority> <command>"
    },
    {
      "id": "s2-34",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset -c 0x00000001 nice -n 10 ./my_program` 将以 CPU 核心 `0` 的亲和性和优先级 `10` 运行 `./my_program`。"
    },
    {
      "id": "s2-35",
      "sectionId": "s2",
      "title": "切换已运行进程的CPU亲和性到其他CPU核心",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -p <cpu_mask> -P <pid>"
    },
    {
      "id": "s2-36",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如：`taskset -p 0x00000001 -P 12345` 将进程ID为12345的进程的CPU亲和性切换到CPU核心 0。"
    },
    {
      "id": "s2-37",
      "sectionId": "s2",
      "title": "将已运行进程的CPU亲和性移动到随机选取的可用CPU核心",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -p --cpu-list - <pid>"
    },
    {
      "id": "s2-38",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如："
    },
    {
      "id": "s2-39",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset -p --cpu-list - 12345"
    },
    {
      "id": "s2-40",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "将进程ID为12345的进程的CPU亲和性移动到一个可用的CPU核心。"
    },
    {
      "id": "s2-41",
      "sectionId": "s2",
      "title": "使用CPU亲和性运行命令，并显示其CPU使用情况",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset <cpu_mask> <command> &\ntop -p <pid>"
    },
    {
      "id": "s2-42",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "例如："
    },
    {
      "id": "s2-43",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "bash",
      "code": "$ taskset 0x00000001 ./my_program &\ntop -p $(pgrep my_program)"
    },
    {
      "id": "s2-44",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "将以CPU核心 `0` 的亲和性运行 `./my_program`，并显示该进程的CPU使用情况。"
    },
    {
      "id": "s2-45",
      "sectionId": "s2",
      "title": "其他",
      "kind": "text",
      "body": "您可以通过范围设置与其他类似指定CPU的相关性"
    },
    {
      "id": "s2-46",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 1-3,12 14846"
    },
    {
      "id": "s2-47",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "或"
    },
    {
      "id": "s2-48",
      "sectionId": "s2",
      "title": "",
      "kind": "code",
      "lang": "shell",
      "code": "$ taskset -cp 1-6:2 14846"
    },
    {
      "id": "s2-49",
      "sectionId": "s2",
      "title": "",
      "kind": "text",
      "body": "后缀 `:N` 指定范围内的步幅，例如 `0-10:3` 被解释为 `0,3,6,9` 列表。"
    },
    {
      "id": "s3-50",
      "sectionId": "s3",
      "title": "另见",
      "kind": "text",
      "body": "[taskset — Linux manual page](https://man7.org/linux/man-pages/man1/taskset.1.html) _(man7.org)_"
    }
  ],
  "source": {
    "repo": "https://github.com/jaywcjlove/reference",
    "path": "docs/taskset.md",
    "ref": "main",
    "url": "https://github.com/jaywcjlove/reference/tree/main/docs/taskset.md",
    "lang": "zh",
    "mode": "local"
  }
}
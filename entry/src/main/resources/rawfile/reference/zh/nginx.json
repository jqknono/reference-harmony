{
  "id": "nginx",
  "title": "判断多个参数示例",
  "sections": [
    {
      "id": "intro",
      "title": "简介",
      "startIndex": 0
    }
  ],
  "cards": [
    {
      "id": "intro-0",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "NGINX 备忘清单\n==="
    },
    {
      "id": "intro-1",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "这个 [nginx](https://nginx.org/en/) 快速参考备忘单显示了它的常用命和配置使用清单。"
    },
    {
      "id": "intro-2",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "入门\n----"
    },
    {
      "id": "intro-3",
      "sectionId": "intro",
      "title": "服务管理",
      "kind": "code",
      "lang": "bash",
      "code": "sudo systemctl reload nginx  # 重新加载 nginx\nsudo systemctl restart nginx # 重启nginx\nnginx           # 启动\nnginx -s reload # 重启\nnginx -s stop   # 关闭进程\nnginx -s quit   # 平滑关闭nginx"
    },
    {
      "id": "intro-4",
      "sectionId": "intro",
      "title": "服务管理",
      "kind": "text",
      "body": "状态"
    },
    {
      "id": "intro-5",
      "sectionId": "intro",
      "title": "服务管理",
      "kind": "code",
      "lang": "bash",
      "code": "sudo systemctl status nginx # nginx当前状态\nnginx -V        # 查看nginx的安装状态，"
    },
    {
      "id": "intro-6",
      "sectionId": "intro",
      "title": "服务管理",
      "kind": "text",
      "body": "检查语法"
    },
    {
      "id": "intro-7",
      "sectionId": "intro",
      "title": "服务管理",
      "kind": "code",
      "lang": "bash",
      "code": "sudo nginx -t   # 检查语法"
    },
    {
      "id": "intro-8",
      "sectionId": "intro",
      "title": "简单代理",
      "kind": "code",
      "lang": "nginx",
      "code": "location / {\n  proxy_pass http://127.0.0.1:3000;\n  proxy_redirect      off;\n  proxy_set_header    Host $host;\n}"
    },
    {
      "id": "intro-9",
      "sectionId": "intro",
      "title": "简单代理",
      "kind": "text",
      "body": "Ubuntu/Debian"
    },
    {
      "id": "intro-10",
      "sectionId": "intro",
      "title": "简单代理",
      "kind": "code",
      "lang": "shell",
      "code": "$ sudo apt update && sudo apt install -y nginx"
    },
    {
      "id": "intro-11",
      "sectionId": "intro",
      "title": "简单代理",
      "kind": "text",
      "body": "RHEL/CentOS"
    },
    {
      "id": "intro-12",
      "sectionId": "intro",
      "title": "简单代理",
      "kind": "code",
      "lang": "shell",
      "code": "$ sudo yum install -y epel-release nginx && sudo systemctl enable --now nginx"
    },
    {
      "id": "intro-13",
      "sectionId": "intro",
      "title": "简单代理",
      "kind": "text",
      "body": "Docker 安装"
    },
    {
      "id": "intro-14",
      "sectionId": "intro",
      "title": "简单代理",
      "kind": "code",
      "lang": "bash",
      "code": "$ docker run --name some-nginx -v /some/content:/usr/share/nginx/html:ro -d nginx"
    },
    {
      "id": "intro-15",
      "sectionId": "intro",
      "title": "配置路径",
      "kind": "text",
      "body": "• `/etc/nginx/nginx.conf` _(main config)_\n• `/etc/nginx/conf.d/*.conf` _(drop‑ins)_\n• `/etc/nginx/sites-available/` + `sites-enabled/` _(Debian style)_\n• `/var/www/html` _(default docroot)_\n• `logs`: `/var/log/nginx/access.log`, `/var/log/nginx/error.log`"
    },
    {
      "id": "intro-16",
      "sectionId": "intro",
      "title": "配置路径",
      "kind": "text",
      "body": "配置\n---"
    },
    {
      "id": "intro-17",
      "sectionId": "intro",
      "title": "全局变量",
      "kind": "text",
      "body": "| 变量 | 说明\n:- | :-\n`$args` | 这个变量等于请求行中的参数，同 `$query_string`\n`$remote_port` | 客户端的端口\n`$content_length` | 请求头中的 `Content-length` 字段\n`$remote_user` | 已经经过 `Auth Basic Module` 验证的用户名\n`$content_type` | 请求头中的 `Content-Type` 字段\n`$request_filename` | 当前请求的文件路径，由 `root` 或alias指令与URI请求生成\n`$document_root` | 当前请求在 `root` 指令中指定的值\n`$scheme` | HTTP方法（如http，https）\n`$host` | 请求主机头字段，否则为服务器名称\n`$hostname` | 主机名\n`$http_user_agent` | 客户端`agent`信息\n`$http_cookie` | 客户端`cookie`信息\n`$server_protocol` | 请求使用的协议，通常是`HTTP/1.0`或`HTTP/1.1`\n`$server_addr` | 服务器地址，在完成一次系统调用后可以确定这个值\n`$server_name` | 服务器名称\n`$server_port` | 请求到达服务器的端口号\n`$limit_rate` | 这个变量可以限制连接速率\n`$request_method` | 客户端请求的动作，如 GET/POST\n`$request_uri` | 包含请求参数的原始URI，不包含主机名，如：`/foo/bar.php?arg=baz`\n`$remote_addr` | 客户端的IP地址\n`$uri` | 不带请求参数的当前URI，`$uri`不包含主机名，如 `/foo/bar.html`\n`$document_uri` | 与 `$uri` 相同\n`$nginx_version` | `nginx` 版本"
    },
    {
      "id": "intro-18",
      "sectionId": "intro",
      "title": "全局变量",
      "kind": "text",
      "body": "更多全局变量[查看官方文档](https://nginx.org/en/docs/varindex.html)"
    },
    {
      "id": "intro-19",
      "sectionId": "intro",
      "title": "监听端口",
      "kind": "code",
      "lang": "nginx",
      "code": "server {\n  listen 80;      # 标准 HTTP 协议\n  listen 443 ssl; # 标准 HTTPS 协议\n  listen 443 ssl http2; # 对于 http2\n  listen [::]:80; # 使用 IPv6 在 80 上收听\n  # 仅收听使用 IPv6\n  listen [::]:80 ipv6only=on;\n}"
    },
    {
      "id": "intro-20",
      "sectionId": "intro",
      "title": "域名 (server_name)",
      "kind": "code",
      "lang": "nginx",
      "code": "server {\n  # 监听 example.com\n  server_name example.com;\n  # 监听多个域\n  server_name example.com www.example.com;\n  # 监听所有子域\n  server_name *.example.com;\n  # 监听所有顶级域\n  server_name example.*;\n  # 监听未指定的主机名（监听 IP 地址本身）\n  server_name \"\";\n}"
    },
    {
      "id": "intro-21",
      "sectionId": "intro",
      "title": "负载均衡(简单实例)",
      "kind": "code",
      "lang": "nginx",
      "code": "upstream node_js {\n  server 0.0.0.0:3000;\n  server 0.0.0.0:4000;\n  server 127.155.142.421;\n}"
    },
    {
      "id": "intro-22",
      "sectionId": "intro",
      "title": "负载均衡(权重)",
      "kind": "code",
      "lang": "nginx",
      "code": "upstream test {\n  server localhost:8080 weight=9;\n  server localhost:8081 weight=1;\n}"
    },
    {
      "id": "intro-23",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "```nginx {2}\nupstream test {\nip_hash;\nserver localhost:8080;\nserver localhost:8081;\n}"
    },
    {
      "id": "intro-24",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n解决负载均衡 `session` 的问题\n\n### upstream fair"
    },
    {
      "id": "intro-25",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "upstream backend {\nfair;\nserver localhost:8080;\nserver localhost:8081;\n}"
    },
    {
      "id": "intro-26",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n响应时间短的优先分配\n\n### server 可选参数\n<!--rehype:wrap-class=row-span-2-->\n\n:- | :-\n:- | :-\n`weight` | 访问权重数值越高，收到请求越多\n`fail_timeout` | 指定的时间内必须提供响应\n`max_fails` | 尝试失败服务器连接的最大次数\n`down` | 标记一个服务器不再接受任何请求\n`backup` | 有服务器宕机，标记的机器接收请求\n\n配置示例"
    },
    {
      "id": "intro-27",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "upstream test {\nserver 127.0.0.1:83 weight=9; # 权重\nserver 127.0.0.1:83 weight=1; # 权重\n# 失败超时时间\nserver 127.0.0.1:83 max_fails=3;\nserver 127.0.0.1:83 weight=3 down;\n}"
    },
    {
      "id": "intro-28",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n### upstream url_hash"
    },
    {
      "id": "intro-29",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "upstream backend {\nhash $request_uri;\nhash_method crc32;\nserver localhost:8080;\nserver localhost:8081;\n}"
    },
    {
      "id": "intro-30",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n按访问url的hash结果来分配请求\n\n### upstream keepalive"
    },
    {
      "id": "intro-31",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "upstream memcached_backend {\nserver 127.0.0.1:11211;\nserver 10.0.0.2:11211;\nkeepalive 32;\n}"
    },
    {
      "id": "intro-32",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n激活缓存以连接到上游服务器\n\n### 子文件夹中的代理\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-33",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "location /folder/ { # / 很重要！\nproxy_pass http://127.0.0.1:3000/; # / 很重要！\nproxy_redirect      off;\nproxy_set_header    Host            $host;\nproxy_set_header    X-Real-IP       $remote_addr;\nproxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;\n}"
    },
    {
      "id": "intro-34",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n### 反向代理\n<!--rehype:wrap-class=row-span-3-->\n\n#### 基础"
    },
    {
      "id": "intro-35",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name example.com;"
    },
    {
      "id": "intro-36",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "location / {\nproxy_pass http://0.0.0.0:3000;\n# 其中 0.0.0.0:3000 是绑定在\n# 0.0.0.0端口3000 列表上的 Node.js 服务器\n}\n}"
    },
    {
      "id": "intro-37",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n#### 基础 + (upstream)"
    },
    {
      "id": "intro-38",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "upstream node_js {\nserver 0.0.0.0:3000;\n# 其中 0.0.0.0:3000 是绑定在\n# 0.0.0.0端口3000 列表上的 Node.js 服务器\n}"
    },
    {
      "id": "intro-39",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name example.com;"
    },
    {
      "id": "intro-40",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "location / {\nproxy_pass http://node_js;\n}\n}"
    },
    {
      "id": "intro-41",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n#### 升级连接（适用于支持 WebSockets 的应用程序）"
    },
    {
      "id": "intro-42",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "upstream node_js {\nserver 0.0.0.0:3000;\n}"
    },
    {
      "id": "intro-43",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name example.com;"
    },
    {
      "id": "intro-44",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "location / {\nproxy_pass http://node_js;\nproxy_redirect off;\nproxy_http_version 1.1;\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection \"upgrade\";\nproxy_set_header Host $host;"
    },
    {
      "id": "intro-45",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "}\n}"
    },
    {
      "id": "intro-46",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n适用于 Node.js、Streamlit、Jupyter 等\n\n### 静态资源（传统 Web 服务器）\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-47",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name example.com;\nroot /path/to/website;\n# root /path/to/website/ 示例，如果里面没有'root'，它将寻找 /path/to/website/index.html\nlocation / {\n}\nlocation /images/ { # 如果里面没有“root”，它将寻找 /path/to/website/images/index.html\n}\nlocation /videos/ { # 由于里面有“root”，它会寻找 /www/media/videos/index.html\nroot /www/media;\n}\n}"
    },
    {
      "id": "intro-48",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n### HTTPS 协议\n<!--rehype:wrap-class=col-span-2-->\n\n大多数 SSL 选项取决于您的应用程序做什么或需要什么"
    },
    {
      "id": "intro-49",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "server {\nlisten 443 ssl http2;\nserver_name example.com;"
    },
    {
      "id": "intro-50",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "ssl_certificate /path/to/cert.pem;\nssl_certificate_key /path/to/privkey.pem;"
    },
    {
      "id": "intro-51",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "# 优化 SSL 配置\nssl_protocols TLSv1.2 TLSv1.3;  # 禁用旧版 TLS\nssl_prefer_server_ciphers on;\nssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\nssl_session_timeout 1d;\nssl_session_cache shared:SSL:10m;"
    },
    {
      "id": "intro-52",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "# 其他配置（如根目录、代理等）\nroot /var/www/html;\nindex index.html;"
    },
    {
      "id": "intro-53",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "location / {\ntry_files $uri $uri/ =404;\n}"
    },
    {
      "id": "intro-54",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "}"
    },
    {
      "id": "intro-55",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n您可以使用 Let's Encrypt 轻松保护您的网站/应用程序。去 [lets-encrypt](https://certbot.eff.org/lets-encrypt/ubuntuxenial-nginx.html) 获取更多信息\n\n虚拟主机与重定向\n---\n\n### 基础服务器块"
    },
    {
      "id": "intro-56",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name example.com www.example.com;\nroot /var/www/example/public;\nindex index.html index.htm;\n}"
    },
    {
      "id": "intro-57",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n### HTTP→HTTPS 重定向"
    },
    {
      "id": "intro-58",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name demo.com www.demo.com;\nreturn 301 https://demo.com$request_uri;\n}"
    },
    {
      "id": "intro-59",
      "sectionId": "intro",
      "title": "upstream ip_hash",
      "kind": "code",
      "lang": "",
      "code": "\n### 规范主机"
    },
    {
      "id": "intro-60",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name www.demo.com;\nreturn 301 $scheme://demo.com$request_uri;\n}"
    },
    {
      "id": "intro-61",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 重定向(301永久)\n<!--rehype:wrap-class=row-span-2-->\n\n将 <www.demo.com> 重定向到 demo.com"
    },
    {
      "id": "intro-62",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name www.demo.com;\nreturn 301 http://demo.com$request_uri;\n}"
    },
    {
      "id": "intro-63",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n将 http 重定向到 https"
    },
    {
      "id": "intro-64",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name demo.com;\nreturn 301 https://demo.com$request_uri;\n}"
    },
    {
      "id": "intro-65",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 重定向(302临时)"
    },
    {
      "id": "intro-66",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name yourdomain.com;\nreturn 302 http://otherdomain.com;\n}"
    },
    {
      "id": "intro-67",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 永久重定向到 HTTPS 安全域"
    },
    {
      "id": "intro-68",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name yourdomain.com;\nreturn 301 https://$host$request_uri;\n}"
    },
    {
      "id": "intro-69",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 重定向参数\n\n:- | :-\n:- | :-\n`permanent` | 永久性重定向。日志中的状态码为 `301`\n`redirect` | 临时重定向。日志中的状态码为 `302`\n\n### HTTP 请求端真实的IP"
    },
    {
      "id": "intro-70",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location / {\nproxy_set_header X-Forwarded-For $remote_addr;\n}"
    },
    {
      "id": "intro-71",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n示例\n----\n<!--rehype:body-class=cols-6-->\n\n### websocket 的代理 keepalive\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-72",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "upstream backend {\nserver 127.0.0.1:3000;\nkeepalive 5;\n}"
    },
    {
      "id": "intro-73",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nserver_name your_hostname.com;\nerror_log /var/log/nginx/rocketchat.access.log;\nlocation / {\nproxy_pass http://backend;\nproxy_http_version 1.1;\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection \"upgrade\";\nproxy_set_header Host $http_host;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forward-For $proxy_add_x_forwarded_for;\nproxy_set_header X-Forward-Proto http;\nproxy_set_header X-Nginx-Proxy true;\nproxy_redirect off;\n}\n}"
    },
    {
      "id": "intro-74",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n### Apache 的反向代理\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-75",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nserver_name domain.tld;"
    },
    {
      "id": "intro-76",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "access_log /log/domain.tld.access.log;\nerror_log /log/domain.tld.error.log;\nroot /var/www/domain.tld/htdocs;"
    },
    {
      "id": "intro-77",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "# 将请求传递给 Apache 后端\nlocation / {\nproxy_pass http://backend;\n}\n# 使用后备处理静态文件\nlocation ~* \\.(ogg|ogv|svg|svgz|eot|otf|woff|woff2|ttf|m4a|mp4|ttf|rss|atom|jpe?g|gif|cur|heic|png|tiff|ico|zip|webm|mp3|aac|tgz|gz|rar|bz2|doc|xls|exe|ppt|tar|mid|midi|wav|bmp|rtf|swf|webp)$ {\nadd_header \"Access-Control-Allow-Origin\" \"*\";\naccess_log off;\nlog_not_found off;\nexpires max;\ntry_files $uri @fallback;\n}\n# 如果找不到文件，则回退以将请求传递给 Apache\nlocation @fallback {\nproxy_pass http://backend;\n}\n}"
    },
    {
      "id": "intro-78",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n### Gitlab 的反向代理\n<!--rehype:wrap-class=col-span-4 row-span-3-->"
    },
    {
      "id": "intro-79",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\n#侦听的80端口\nlisten       80;\nserver_name  git.example.cn;\nlocation / {\nproxy_pass   http://localhost:3000;\n# 以下是一些反向代理的配置可删除\nproxy_redirect             off;\n# 后端的Web服务器可以通过X-Forwarded-For获取用户真实IP\nproxy_set_header           Host $host;\nclient_max_body_size       10m;  # 允许客户端请求的最大单文件字节数\nclient_body_buffer_size    128k; # 缓冲区代理缓冲用户端请求的最大字节数\nproxy_connect_timeout      300;  # nginx跟后端服务器连接超时时间(代理连接超时)\nproxy_send_timeout         300;  # 后端服务器数据回传时间(代理发送超时)\nproxy_read_timeout         300;  # 连接成功后，后端服务器响应时间(代理接收超时)\n# 设置代理服务器（nginx）保存用户头信息的缓冲区大小\nproxy_buffer_size          4k;\n# proxy_buffers缓冲区，网页平均在32k以下的话，这样设置\nproxy_buffers              4 32k;\n# 高负荷下缓冲大小（proxy_buffers*2）\nproxy_busy_buffers_size    64k;\n}\n}"
    },
    {
      "id": "intro-80",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 重定向整个网站\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-81",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nserver_name old-site.com;\nreturn 301 $scheme://new-site.com$request_uri;\n}"
    },
    {
      "id": "intro-82",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n### 重定向单页\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-83",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlocation = /oldpage.html {\nreturn 301 http://example.org/newpage.html;\n}\n}"
    },
    {
      "id": "intro-84",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n### 重定向整个子路径\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-85",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location /old-site {\nrewrite ^/old-site/(.*) http://example.org/new-site/$1 permanent;\n}"
    },
    {
      "id": "intro-86",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n### 负载均衡\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-87",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "upstream example {\nip_hash;\n# upstream的负载均衡，weight是权重，可以根据机器配置定义权重。\n# weigth参数表示权值，权值越高被分配到的几率越大。\nserver 192.168.122.11:8081 ;\nserver 127.0.0.1:82 weight=3;\nserver 127.0.0.1:83 weight=3 down;\nserver 127.0.0.1:84 weight=3; max_fails=3  fail_timeout=20s;\nserver 127.0.0.1:85 weight=4;\nkeepalive 32;\n}\nserver {\n#侦听的80端口\nlisten       80;\nserver_name  git.example.cn;\nlocation / {\n# 在这里设置一个代理，和 upstream 的名字一样\nproxy_pass   http://example;\n}\n}"
    },
    {
      "id": "intro-88",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 内容缓存\n<!--rehype:wrap-class=col-span-3-->\n\n允许浏览器基本上永久地缓存静态内容。 Nginx 将为您设置 Expires 和 Cache-Control 头信息"
    },
    {
      "id": "intro-89",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location /static {\nroot /data;\nexpires max;\n}"
    },
    {
      "id": "intro-90",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n如果要求浏览器永远不会缓存响应（例如用于跟踪请求），请使用 `-1`"
    },
    {
      "id": "intro-91",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location = /empty.gif {\nempty_gif;\nexpires -1;\n}"
    },
    {
      "id": "intro-92",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 跨域问题\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-93",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name api.xxx.com;"
    },
    {
      "id": "intro-94",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "add_header 'Access-Control-Allow-Origin' '*';\nadd_header 'Access-Control-Allow-Credentials' 'true';\nadd_header 'Access-Control-Allow-Methods' 'GET,POST,HEAD';"
    },
    {
      "id": "intro-95",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location / {\nproxy_pass http://127.0.0.1:3000;\nproxy_set_header X-Real-IP $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header Host  $http_host;\n}\n}"
    },
    {
      "id": "intro-96",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 重定向 URI 来解决跨域问题\n<!--rehype:wrap-class=col-span-3 row-span-2-->"
    },
    {
      "id": "intro-97",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "upstream test {\nserver 127.0.0.1:8080;\nserver localhost:8081;\n}\nserver {\nlisten 80;\nserver_name api.xxx.com;\nlocation / {\nroot  html;                   # 去请求../html文件夹里的文件\nindex  index.html index.htm;  # 首页响应地址\n}\n# 用于拦截请求，匹配任何以 /api/开头的地址，\n# 匹配符合以后，停止往下搜索正则。\nlocation ^~/api/{\n# 代表重写拦截进来的请求，并且只能对域名后边的除去传递的参数外的字符串起作用\n# 例如www.a.com/api/msg?meth=1&par=2重写，只对/api/msg重写。\n# rewrite后面的参数是一个简单的正则 ^/api/(.*)$，\n# $1代表正则中的第一个()，$2代表第二个()的值，以此类推。\nrewrite ^/api/(.*)$ /$1 break;"
    },
    {
      "id": "intro-98",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "# 把请求代理到其他主机\n# 其中 http://www.b.com/ 写法和 http://www.b.com写法的区别如下\n# 如果你的请求地址是他 http://server/html/test.jsp\n# 配置一： http://www.b.com/ 后面有“/”\n#         将反向代理成 http://www.b.com/html/test.jsp 访问\n# 配置一： http://www.b.com 后面没有有“/”\n#         将反向代理成 http://www.b.com/test.jsp 访问\nproxy_pass http://test;"
    },
    {
      "id": "intro-99",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "# 如果 proxy_pass  URL 是 http://a.xx.com/platform/ 这种情况\n# proxy_cookie_path应该设置成 /platform/ / (注意两个斜杠之间有空格)。\nproxy_cookie_path /platfrom/ /;"
    },
    {
      "id": "intro-100",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "# 设置 Cookie 头通过\nproxy_pass_header Set-Cookie;\n}\n}"
    },
    {
      "id": "intro-101",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 跳转到带 www 的域上面\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-102",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\n# 配置正常的带www的域名\nserver_name www.wangchujiang.com;\nroot /home/www/wabg/download;\nlocation / {\ntry_files $uri $uri/ /index.html =404;\n}\n}"
    },
    {
      "id": "intro-103",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\n# 将不带 www 的 wangchujiang.com\n# 永久性重定向到 https://www.wangchujiang.com\nserver_name wangchujiang.com;\nrewrite ^(.*) https://www.wangchujiang.com$1 permanent;\n}"
    },
    {
      "id": "intro-104",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 代理转发\n<!--rehype:wrap-class=col-span-2 row-span-2-->"
    },
    {
      "id": "intro-105",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "upstream server-api {\n# api 代理服务地址\nserver 127.0.0.1:3110;\n}\nupstream server-resource {\n# 静态资源 代理服务地址\nserver 127.0.0.1:3120;\n}\nserver {\nlisten       3111;\nserver_name  localhost; # 这里指定域名\nroot /home/www/server-statics;\n# 匹配 api 路由的反向代理到API服务\nlocation ^~/api/ {\nrewrite ^/(.*)$ /$1 break;\nproxy_pass http://server-api;\n}\n# 假设这里验证码也在API服务中\nlocation ^~/captcha {\nrewrite ^/(.*)$ /$1 break;\nproxy_pass http://server-api;\n}\n# 假设你的图片资源全部在另外一个服务上面\nlocation ^~/img/ {\nrewrite ^/(.*)$ /$1 break;\nproxy_pass http://server-resource;\n}\n# 路由在前端，后端没有真实路由，\n# 路由不存在的 404 状态的页面返回 /index.html\n# 使用场景，用在 React/Vue项目没有真实路由\nlocation / {\ntry_files $uri $uri/ /index.html =404;\n#                      空格很重要 ^\n}\n}"
    },
    {
      "id": "intro-106",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 屏蔽 IP\n<!--rehype:wrap-class=col-span-4-->\n\n可以放到 `http`, `server`, `location`, `limit_except` 语句块"
    },
    {
      "id": "intro-107",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "include blockip.conf;"
    },
    {
      "id": "intro-108",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n在 `blockip.conf` 里面输入内容，如："
    },
    {
      "id": "intro-109",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "deny 165.91.122.67;"
    },
    {
      "id": "intro-110",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "deny IP;            # 屏蔽单个 ip 访问\nallow IP;           # 允许单个 ip 访问\ndeny all;           # 屏蔽所有 ip 访问\nallow all;          # 允许所有 ip 访问\ndeny 123.0.0.0/8;   # 屏蔽整个段即从 123.0.0.1 到 123.255.255.254 访问的命令\ndeny 124.45.0.0/16; # 屏蔽IP段即从 123.45.0.1 到 123.45.255.254 访问的命令\ndeny 123.45.6.0/24; # 屏蔽IP段即从 123.45.6.1 到 123.45.6.254 访问的命令"
    },
    {
      "id": "intro-111",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "allow 1.1.1.1;\nallow 1.1.1.2;\ndeny all;"
    },
    {
      "id": "intro-112",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 强制将 http 重定向到 https\n<!--rehype:wrap-class=col-span-4-->"
    },
    {
      "id": "intro-113",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten       80;\nserver_name  example.com;\nrewrite ^ https://$http_host$request_uri? permanent; # 强制将 http 重定向到 https\n# 在错误页面和“服务器”响应头字段中启用或禁用发射nginx版本。 防止黑客利用版本漏洞攻击\nserver_tokens off;\n}"
    },
    {
      "id": "intro-114",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 代理转发连接替换\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-115",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ^~/api/upload {\nrewrite ^/(.*)$ /wfs/v1/upload break;\nproxy_pass http://wfs-api;\n}"
    },
    {
      "id": "intro-116",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n将地址 `/api/upload` 替换为 `/wfs/v1/upload`\n\n### 爬虫 User-Agent 过滤\n<!--rehype:wrap-class=col-span-4-->"
    },
    {
      "id": "intro-117",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location / {\nif ($http_user_agent ~* \"python|curl|java|wget|httpclient|okhttp\") {\nreturn 503;\n}\n# 正常处理\n# ...\n}"
    },
    {
      "id": "intro-118",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 图片防盗链\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-119",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ~* \\.(gif|jpg|png|swf|flv)$ {\nroot html;"
    },
    {
      "id": "intro-120",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "valid_referers none blocked *.nginx.com;"
    },
    {
      "id": "intro-121",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "if ($invalid_referer) {\nrewrite ^/ www.nginx.cn;\n# return 404;\n}\n}"
    },
    {
      "id": "intro-122",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 虚拟目录配置\n<!--rehype:wrap-class=col-span-2-->"
    },
    {
      "id": "intro-123",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location /img/ {\nalias /var/www/image/;\n}"
    },
    {
      "id": "intro-124",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location /img/ {\nroot /var/www/image;\n}"
    },
    {
      "id": "intro-125",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 屏蔽文件目录\n<!--rehype:wrap-class=col-span-2 row-span-2-->\n\n通用备份和归档文件"
    },
    {
      "id": "intro-126",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ~* \"\\.(old|orig|original|php#|php~|php_bak|save|swo|aspx?|tpl|sh|bash|bak?|cfg|cgi|dll|exe|git|hg|ini|jsp|log|mdb|out|sql|svn|swp|tar|rdf)$\" {\ndeny all;\n}"
    },
    {
      "id": "intro-127",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n拒绝访问 `.git` 和 `.svn` 目录"
    },
    {
      "id": "intro-128",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ~ (.git|.svn) {\ndeny all;\n}"
    },
    {
      "id": "intro-129",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "<!--rehype:className=wrap-text -->\n\n拒绝访问隐藏文件和目录"
    },
    {
      "id": "intro-130",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ~ /\\.(?!well-known\\/) {\ndeny all;\n}"
    },
    {
      "id": "intro-131",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 防盗图配置\n<!--rehype:wrap-class=col-span-4-->"
    },
    {
      "id": "intro-132",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ~ \\/public\\/(css|js|img)\\/.*\\.(js|css|gif|jpg|jpeg|png|bmp|swf) {\nvalid_referers none blocked *.jslite.io;\nif ($invalid_referer) {\nrewrite ^/  http://wangchujiang.com/piratesp.png;\n}\n}"
    },
    {
      "id": "intro-133",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### ulimit 不继承系统设置的问题\n<!--rehype:wrap-class=col-span-2-->\n\n- 执行 status 命令\n\n  ```bash\n  sudo service nginx status\n  ```\n\n  执行 status 命令，看到 Loaded: loaded (/lib/systemd/system/nginx.service;...) 这一行的nginx.service 文件位置\n\n- 打开 service 文件\n\n  ```bash\n  sudo vim /lib/systemd/system/nginx.service\n  ```\n\n- 修改 service 中的配置\n  找到 `[Service]` 部分，将 `LimitNOFILE=65535` 添加到该部分\n\n  ```bash\n  [Service]\n  ...\n  LimitNOFILE=65535\n  ...\n  ```\n<!--rehype:className=style-timeline-->\n\n解决 `systemctl` 管理的 ulimit 不继承系统设置的问题\n\n### Gzip 配置\n<!--rehype:wrap-class=col-span-4-->"
    },
    {
      "id": "intro-134",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "gzip  on;\ngzip_buffers 16 8k;\ngzip_comp_level 6;\ngzip_http_version 1.1;\ngzip_min_length 256;\ngzip_proxied any;\ngzip_vary on;\ngzip_types\ntext/xml application/xml application/atom+xml application/rss+xml application/xhtml+xml image/svg+xml\ntext/javascript application/javascript application/x-javascript\ntext/x-json application/json application/x-web-app-manifest+json\ntext/css text/plain text/x-component\nfont/opentype application/x-font-ttf application/vnd.ms-fontobject\nimage/x-icon;\ngzip_disable  \"msie6\";"
    },
    {
      "id": "intro-135",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 阻止常见攻击\n<!--rehype:wrap-class=col-span-3-->\n\n#### base64编码的网址"
    },
    {
      "id": "intro-136",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ~* \"(base64_encode)(.*)(\\()\" {\ndeny all;\n}"
    },
    {
      "id": "intro-137",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n#### javascript eval() url"
    },
    {
      "id": "intro-138",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location ~* \"(eval\\()\" {\ndeny all;\n}"
    },
    {
      "id": "intro-139",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 使网站不可索引\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-140",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "add_header X-Robots-Tag \"noindex\";"
    },
    {
      "id": "intro-141",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location = /robots.txt {\nreturn 200 \"User-agent: *\\nDisallow: /\\n\";\n}"
    },
    {
      "id": "intro-142",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 获取请求ip\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-143",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 80;\nserver_name xxx.top;"
    },
    {
      "id": "intro-144",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location / {\naccess_log /data/logs/nginx/json_ip.log json;\nproxy_set_header Host $http_host;\nproxy_set_header X-Real-Ip $remote_addr;\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_pass http://127.0.0.1:9999;\n}\n}"
    },
    {
      "id": "intro-145",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten 9999;"
    },
    {
      "id": "intro-146",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location / {\naccess_log off;\ndefault_type application/json;\nreturn 200 \"{\\\"ip\\\":\\\"$http_X_Real_Ip\\\"}\";\n}\n}"
    },
    {
      "id": "intro-147",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 判断请求参数\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-148",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "set $flagts 0;\nif ( $arg_aaa ~ \"^aaa\" ) {\nset $flagts \"${flagts}1\";\n}\nif ( $arg_bbb ~ \"^bbb\" ) {\nset $flagts \"${flagts}1\";\n}\nif ( $flagts = \"011\" ) {\nreturn 200;\n}"
    },
    {
      "id": "intro-149",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n### 流量镜像配置\n<!--rehype:wrap-class=col-span-3-->"
    },
    {
      "id": "intro-150",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "server {\nlisten       80;\nserver_name 192.168.1.1;"
    },
    {
      "id": "intro-151",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location = /mirror1 {\ninternal;\n#### address1 ####\nproxy_set_header Host mirror1.com;\nproxy_pass http://127.0.0.1:8008/api/service/list;\n}"
    },
    {
      "id": "intro-152",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location = /mirror2 {\ninternal;\n#### address2 ####\nproxy_set_header Host mirror2.com;\nproxy_pass http://127.0.0.1:8009/api/service/list;\n}"
    },
    {
      "id": "intro-153",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "# 只转发这个接口\nlocation /api/service/list {\naccess_log /data/logs/nginx/json_test_to_mirror.log json;\nmirror /mirror1;\nmirror /mirror2;\nproxy_pass http://127.0.0.1:8007;\n}"
    },
    {
      "id": "intro-154",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "location / {\naccess_log /data/logs/nginx/json_test.log json;\nproxy_pass http://192.168.1.1:8007;\n}"
    },
    {
      "id": "intro-155",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "}"
    },
    {
      "id": "intro-156",
      "sectionId": "intro",
      "title": "简介",
      "kind": "code",
      "lang": "",
      "code": "\n另见\n---\n\n- [Nginx 安装维护入门学习笔记](https://jaywcjlove.github.io/nginx-tutorial) _(jaywcjlove.github.io)_\n- [advanced-nginx-cheatsheet](https://virtubox.github.io/advanced-nginx-cheatsheet/) _(virtubox.github.io)_"
    }
  ],
  "source": {
    "repo": "https://github.com/jaywcjlove/reference",
    "path": "docs/nginx.md",
    "ref": "main",
    "url": "https://github.com/jaywcjlove/reference/tree/main/docs/nginx.md",
    "generatedAt": "2025-12-16T07:36:11.344Z",
    "lang": "zh",
    "mode": "local"
  }
}
{
  "id": "postgres",
  "name": "PostgreSQL 备忘清单",
  "title": "[PostgreSQL](https://www.postgresql.org/docs/current/) 备忘清单为您提供了常用的 PostgreSQL 命令和语句。",
  "icon": "https://raw.githubusercontent.com/jaywcjlove/reference/main/assets/postgres.svg",
  "sections": [
    {
      "id": "intro",
      "title": "简介",
      "startIndex": 0
    },
    {
      "id": "s1",
      "title": "入门",
      "startIndex": 1
    },
    {
      "id": "s2",
      "title": "PostgreSQL 工作",
      "startIndex": 12
    },
    {
      "id": "s3",
      "title": "PostgreSQL 命令",
      "startIndex": 108
    },
    {
      "id": "s4",
      "title": "各种各样的",
      "startIndex": 118
    },
    {
      "id": "s5",
      "title": "另见",
      "startIndex": 147
    }
  ],
  "cards": [
    {
      "id": "intro-0",
      "sectionId": "intro",
      "title": "简介",
      "kind": "text",
      "body": "[PostgreSQL](https://www.postgresql.org/docs/current/) 备忘清单为您提供了常用的 PostgreSQL 命令和语句。"
    },
    {
      "id": "s1-1",
      "sectionId": "s1",
      "title": "入门",
      "kind": "text",
      "body": "切换和连接"
    },
    {
      "id": "s1-2",
      "sectionId": "s1",
      "title": "入门",
      "kind": "code",
      "lang": "shell",
      "code": "$ sudo -u postgres psql"
    },
    {
      "id": "s1-3",
      "sectionId": "s1",
      "title": "入门",
      "kind": "text",
      "body": "列出所有数据库"
    },
    {
      "id": "s1-4",
      "sectionId": "s1",
      "title": "入门",
      "kind": "code",
      "lang": "shell",
      "code": "postgres=# \\l"
    },
    {
      "id": "s1-5",
      "sectionId": "s1",
      "title": "入门",
      "kind": "text",
      "body": "连接到名为 postgres 的数据库"
    },
    {
      "id": "s1-6",
      "sectionId": "s1",
      "title": "入门",
      "kind": "code",
      "lang": "shell",
      "code": "postgres=# \\c postgres"
    },
    {
      "id": "s1-7",
      "sectionId": "s1",
      "title": "入门",
      "kind": "text",
      "body": "断开"
    },
    {
      "id": "s1-8",
      "sectionId": "s1",
      "title": "入门",
      "kind": "code",
      "lang": "shell",
      "code": "postgres=# \\q\npostgres=# \\!"
    },
    {
      "id": "s1-9",
      "sectionId": "s1",
      "title": "psql 命令",
      "kind": "text",
      "body": "参数 | 示例 | 说明\n:- |- | -\n`[-d] <database>`   | psql -d mydb                                 | 连接到数据库\n`-U`                | psql -U john mydb                            | 以特定用户身份连接\n`-h` `-p`           | psql -h localhost -p 5432 mydb               | 连接到主机/端口\n`-U` `-h` `-p` `-d` | psql -U admin -h 192.168.1.5 -p 2506 -d mydb | 连接远程 PostgreSQL\n`-W`                | psql -W mydb                                 | 强制密码\n`-c`                | psql -c '\\c postgres' -c '\\dt'               | 执行 SQL 查询或命令\n`-H`                | psql -c \"\\l+\" -H postgres > database.html    | 生成 HTML 报告\n`-l`                | psql -l                                      | 列出所有数据库\n`-f`                | psql mydb -f file.sql                        | 从文件执行命令\n`-V`                | psql -V                                      | 打印 psql 版本\n<!--rehype:className=show-header-->"
    },
    {
      "id": "s1-10",
      "sectionId": "s1",
      "title": "获得帮助",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\h`        | SQL 命令语法帮助\n`\\h` DELETE | DELETE SQL 语句语法\n`\\?`        | PostgreSQL 命令列表"
    },
    {
      "id": "s1-11",
      "sectionId": "s1",
      "title": "获得帮助",
      "kind": "text",
      "body": "在 PostgreSQL 控制台中运行"
    },
    {
      "id": "s2-12",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "显示版本"
    },
    {
      "id": "s2-13",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "SHOW SERVER_VERSION;"
    },
    {
      "id": "s2-14",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "显示系统状态"
    },
    {
      "id": "s2-15",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "\\conninfo"
    },
    {
      "id": "s2-16",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "显示环境变量"
    },
    {
      "id": "s2-17",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "SHOW ALL;"
    },
    {
      "id": "s2-18",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "列出用户"
    },
    {
      "id": "s2-19",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT rolname FROM pg_roles;"
    },
    {
      "id": "s2-20",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "显示当前用户"
    },
    {
      "id": "s2-21",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT current_user;"
    },
    {
      "id": "s2-22",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "显示当前用户的权限"
    },
    {
      "id": "s2-23",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "\\du"
    },
    {
      "id": "s2-24",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "显示当前数据库"
    },
    {
      "id": "s2-25",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT current_database();"
    },
    {
      "id": "s2-26",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "显示数据库中的所有表"
    },
    {
      "id": "s2-27",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "\\dt"
    },
    {
      "id": "s2-28",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "text",
      "body": "列出函数"
    },
    {
      "id": "s2-29",
      "sectionId": "s2",
      "title": "Recon 观察",
      "kind": "code",
      "lang": "sql",
      "code": "\\df <schema>"
    },
    {
      "id": "s2-30",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "text",
      "body": "列出数据库"
    },
    {
      "id": "s2-31",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "code",
      "lang": "sql",
      "code": "\\l"
    },
    {
      "id": "s2-32",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "text",
      "body": "连接到数据库"
    },
    {
      "id": "s2-33",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "code",
      "lang": "sql",
      "code": "\\c <database_name>"
    },
    {
      "id": "s2-34",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "text",
      "body": "显示当前数据库"
    },
    {
      "id": "s2-35",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT current_database();"
    },
    {
      "id": "s2-36",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "text",
      "body": "[创建数据库](http://www.postgresql.org/docs/current/static/sql-createdatabase.html)"
    },
    {
      "id": "s2-37",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "code",
      "lang": "sql",
      "code": "CREATE DATABASE <database_name> WITH OWNER <username>;"
    },
    {
      "id": "s2-38",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "text",
      "body": "[删除数据库](http://www.postgresql.org/docs/current/static/sql-dropdatabase.html)"
    },
    {
      "id": "s2-39",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "code",
      "lang": "sql",
      "code": "DROP DATABASE IF EXISTS <database_name>;"
    },
    {
      "id": "s2-40",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "text",
      "body": "[重命名数据库](http://www.postgresql.org/docs/current/static/sql-alterdatabase.html)"
    },
    {
      "id": "s2-41",
      "sectionId": "s2",
      "title": "Databases 数据库",
      "kind": "code",
      "lang": "sql",
      "code": "ALTER DATABASE <old_name> RENAME TO <new_name>;"
    },
    {
      "id": "s2-42",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "text",
      "body": "列出当前数据库中的表"
    },
    {
      "id": "s2-43",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "code",
      "lang": "sql",
      "code": "\\dt\nSELECT table_schema,table_name FROM information_schema.tables ORDER BY table_schema,table_name;"
    },
    {
      "id": "s2-44",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "text",
      "body": "全局列表"
    },
    {
      "id": "s2-45",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "code",
      "lang": "sql",
      "code": "\\dt *.*.\nSELECT * FROM pg_catalog.pg_tables"
    },
    {
      "id": "s2-46",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "text",
      "body": "列出表结构"
    },
    {
      "id": "s2-47",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "code",
      "lang": "sql",
      "code": "\\d <table_name>\n\\d+ <table_name>\nSELECT column_name, data_type, character_maximum_length\nFROM INFORMATION_SCHEMA.COLUMNS\nWHERE table_name = '<table_name>';"
    },
    {
      "id": "s2-48",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "text",
      "body": "[创建表](http://www.postgresql.org/docs/current/static/sql-createtable.html)"
    },
    {
      "id": "s2-49",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "code",
      "lang": "sql",
      "code": "CREATE TABLE <table_name>(\n  <column_name> <column_type>,\n  <column_name> <column_type>\n);"
    },
    {
      "id": "s2-50",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "text",
      "body": "创建表，主键自增"
    },
    {
      "id": "s2-51",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "code",
      "lang": "sql",
      "code": "CREATE TABLE <table_name> (\n  <column_name> SERIAL PRIMARY KEY\n);"
    },
    {
      "id": "s2-52",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "text",
      "body": "[删除表](http://www.postgresql.org/docs/current/static/sql-droptable.html)"
    },
    {
      "id": "s2-53",
      "sectionId": "s2",
      "title": "Tables 表",
      "kind": "code",
      "lang": "sql",
      "code": "DROP TABLE IF EXISTS <table_name> CASCADE;"
    },
    {
      "id": "s2-54",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "成为 postgres 用户，如果您有权限错误"
    },
    {
      "id": "s2-55",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "shell",
      "code": "sudo su - postgres\npsql"
    },
    {
      "id": "s2-56",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "[授予](http://www.postgresql.org/docs/current/static/sql-grant.html) 对数据库的所有权限"
    },
    {
      "id": "s2-57",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "sql",
      "code": "GRANT ALL PRIVILEGES ON DATABASE <db_name> TO <user_name>;"
    },
    {
      "id": "s2-58",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "授予数据库连接权限"
    },
    {
      "id": "s2-59",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "sql",
      "code": "GRANT CONNECT ON DATABASE <db_name> TO <user_name>;"
    },
    {
      "id": "s2-60",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "授予架构权限"
    },
    {
      "id": "s2-61",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "sql",
      "code": "GRANT USAGE ON SCHEMA public TO <user_name>;"
    },
    {
      "id": "s2-62",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "授予函数权限"
    },
    {
      "id": "s2-63",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "sql",
      "code": "GRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA public TO <user_name>;"
    },
    {
      "id": "s2-64",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "授予在所有表上选择、更新、插入、删除的权限"
    },
    {
      "id": "s2-65",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "sql",
      "code": "GRANT SELECT, UPDATE, INSERT ON ALL TABLES IN SCHEMA public TO <user_name>;"
    },
    {
      "id": "s2-66",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "在表上授予权限"
    },
    {
      "id": "s2-67",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "sql",
      "code": "GRANT SELECT, UPDATE, INSERT ON <table_name> TO <user_name>;"
    },
    {
      "id": "s2-68",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "text",
      "body": "授予对表的选择权限"
    },
    {
      "id": "s2-69",
      "sectionId": "s2",
      "title": "Permissions 权限",
      "kind": "code",
      "lang": "sql",
      "code": "GRANT SELECT ON ALL TABLES IN SCHEMA public TO <user_name>;"
    },
    {
      "id": "s2-70",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "text",
      "body": "[添加栏目](http://www.postgresql.org/docs/current/static/sql-altertable.html)"
    },
    {
      "id": "s2-71",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "code",
      "lang": "sql",
      "code": "ALTER TABLE <table_name> IF EXISTS\nADD <column_name> <data_type> [<constraints>];"
    },
    {
      "id": "s2-72",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "text",
      "body": "更新栏"
    },
    {
      "id": "s2-73",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "code",
      "lang": "sql",
      "code": "ALTER TABLE <table_name> IF EXISTS\nALTER <column_name> TYPE <data_type> [<constraints>];"
    },
    {
      "id": "s2-74",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "text",
      "body": "删除列"
    },
    {
      "id": "s2-75",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "code",
      "lang": "sql",
      "code": "ALTER TABLE <table_name> IF EXISTS\nDROP <column_name>;"
    },
    {
      "id": "s2-76",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "text",
      "body": "将列更新为自增主键"
    },
    {
      "id": "s2-77",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "code",
      "lang": "sql",
      "code": "ALTER TABLE <table_name>\nADD COLUMN <column_name> SERIAL PRIMARY KEY;"
    },
    {
      "id": "s2-78",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "text",
      "body": "使用自动递增的主键插入表中"
    },
    {
      "id": "s2-79",
      "sectionId": "s2",
      "title": "Columns 列",
      "kind": "code",
      "lang": "sql",
      "code": "INSERT INTO <table_name>\nVALUES (DEFAULT, <value1>);\nINSERT INTO <table_name> (<column1_name>,<column2_name>)\nVALUES ( <value1>,<value2> );"
    },
    {
      "id": "s2-80",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "text",
      "body": "[选择](http://www.postgresql.org/docs/current/static/sql-select.html) 所有数据"
    },
    {
      "id": "s2-81",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT * FROM <table_name>;"
    },
    {
      "id": "s2-82",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "text",
      "body": "读取一行数据"
    },
    {
      "id": "s2-83",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT * FROM <table_name> LIMIT 1;"
    },
    {
      "id": "s2-84",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "text",
      "body": "搜索数据"
    },
    {
      "id": "s2-85",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT * FROM <table_name> WHERE <column_name> = <value>;"
    },
    {
      "id": "s2-86",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "text",
      "body": "[插入](http://www.postgresql.org/docs/current/static/sql-insert.html) 数据"
    },
    {
      "id": "s2-87",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "code",
      "lang": "sql",
      "code": "INSERT INTO <table_name> VALUES( <value_1>, <value_2> );"
    },
    {
      "id": "s2-88",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "text",
      "body": "[更新](http://www.postgresql.org/docs/current/static/sql-update.html) 数据"
    },
    {
      "id": "s2-89",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "code",
      "lang": "sql",
      "code": "UPDATE <table_name>\nSET <column_1> = <value_1>, <column_2> = <value_2>\nWHERE <column_1> = <value>;"
    },
    {
      "id": "s2-90",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "text",
      "body": "[删除](http://www.postgresql.org/docs/current/static/sql-delete.html) 所有数据"
    },
    {
      "id": "s2-91",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "code",
      "lang": "sql",
      "code": "DELETE FROM <table_name>;"
    },
    {
      "id": "s2-92",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "text",
      "body": "删除特定数据"
    },
    {
      "id": "s2-93",
      "sectionId": "s2",
      "title": "Data 数据",
      "kind": "code",
      "lang": "sql",
      "code": "DELETE FROM <table_name>\nWHERE <column_name> = <value>;"
    },
    {
      "id": "s2-94",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "text",
      "body": "列出角色"
    },
    {
      "id": "s2-95",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "code",
      "lang": "sql",
      "code": "SELECT rolname FROM pg_roles;"
    },
    {
      "id": "s2-96",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "text",
      "body": "[创建用户](http://www.postgresql.org/docs/current/static/sql-createuser.html)"
    },
    {
      "id": "s2-97",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "code",
      "lang": "sql",
      "code": "CREATE USER <user_name> WITH PASSWORD '<password>';"
    },
    {
      "id": "s2-98",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "text",
      "body": "[删除用户](http://www.postgresql.org/docs/current/static/sql-dropuser.html)"
    },
    {
      "id": "s2-99",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "code",
      "lang": "sql",
      "code": "DROP USER IF EXISTS <user_name>;"
    },
    {
      "id": "s2-100",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "text",
      "body": "[更改](http://www.postgresql.org/docs/current/static/sql-alterrole.html) 用户密码"
    },
    {
      "id": "s2-101",
      "sectionId": "s2",
      "title": "Users 用户",
      "kind": "code",
      "lang": "sql",
      "code": "ALTER ROLE <user_name> WITH PASSWORD '<password>';"
    },
    {
      "id": "s2-102",
      "sectionId": "s2",
      "title": "Schema",
      "kind": "text",
      "body": "列出 Schemas"
    },
    {
      "id": "s2-103",
      "sectionId": "s2",
      "title": "Schema",
      "kind": "code",
      "lang": "sql",
      "code": "\\dn\nSELECT schema_name FROM information_schema.schemata;\nSELECT nspname FROM pg_catalog.pg_namespace;"
    },
    {
      "id": "s2-104",
      "sectionId": "s2",
      "title": "Schema",
      "kind": "text",
      "body": "[创建架构](http://www.postgresql.org/docs/current/static/sql-createschema.html)"
    },
    {
      "id": "s2-105",
      "sectionId": "s2",
      "title": "Schema",
      "kind": "code",
      "lang": "sql",
      "code": "CREATE SCHEMA IF NOT EXISTS <schema_name>;"
    },
    {
      "id": "s2-106",
      "sectionId": "s2",
      "title": "Schema",
      "kind": "text",
      "body": "[删除模式](http://www.postgresql.org/docs/current/static/sql-dropschema.html)"
    },
    {
      "id": "s2-107",
      "sectionId": "s2",
      "title": "Schema",
      "kind": "code",
      "lang": "sql",
      "code": "DROP SCHEMA IF EXISTS <schema_name> CASCADE;"
    },
    {
      "id": "s3-108",
      "sectionId": "s3",
      "title": "表",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\d <table>`     | 描述表\n`\\d+ <table>`    | 详细描述表格\n`\\dt`            | 列出当前模式中的表\n`\\dt *.*`        | 列出所有模式中的表\n`\\dt <schema>.*` | 列出架构的表\n`\\dp`            | 列出表访问权限\n`\\det[+]`        | 列出外部表"
    },
    {
      "id": "s3-109",
      "sectionId": "s3",
      "title": "查询缓冲区",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\e [FILE]`  | 编辑查询缓冲区(或文件)\n`\\ef [FUNC]` | 编辑函数定义\n`\\p`         | 显示内容\n`\\r`         | 重置(清除)查询缓冲区\n`\\s [FILE]`  | 显示历史记录或保存到文件\n`\\w FILE`    | 将查询缓冲区写入文件"
    },
    {
      "id": "s3-110",
      "sectionId": "s3",
      "title": "信息",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\l[+]`         | 列出所有数据库\n`\\dn[S+]`       | 列出架构\n`\\di[S+]`       | 列出索引\n`\\du[+]`        | 列出角色\n`\\ds[S+]`       | 列出序列\n`\\df[antw][S+]` | 列出函数\n`\\deu[+]`       | 列出用户映射\n`\\dv[S+]`       | 列表视图\n`\\dl`           | 列出大对象\n`\\dT[S+]`       | 列出数据类型\n`\\da[S]`        | 列出聚合\n`\\db[+]`        | 列出表空间\n`\\dc[S+]`       | 列出转化\n`\\dC[+]`        | 列出演员表\n`\\ddp`          | 列出默认权限\n`\\dd[S]`        | 显示对象描述\n`\\dD[S+]`       | 列出域\n`\\des[+]`       | 列出国外服务器\n`\\dew[+]`       | 列出外部数据包装器\n`\\dF[+]`        | 列出文本搜索配置\n`\\dFd[+]`       | 列出文本搜索词典\n`\\dFp[+]`       | 列出文本搜索解析器\n`\\dFt[+]`       | 列出文本搜索模板\n`\\dL[S+]`       | 列出程序语言\n`\\do[S]`        | 列出运算符\n`\\dO[S+]`       | 列出排序规则\n`\\drds`         | 列出每个数据库的角色设置\n`\\dx[+]`        | 列出扩展"
    },
    {
      "id": "s3-111",
      "sectionId": "s3",
      "title": "信息",
      "kind": "text",
      "body": "`S`：显示系统对象，`+`：附加细节"
    },
    {
      "id": "s3-112",
      "sectionId": "s3",
      "title": "连接",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\c [DBNAME]`          | 连接到新数据库\n`\\encoding [ENCODING]` | 显示或设置客户端编码\n`\\password [USER]`     | 更改密码\n`\\conninfo`            | 显示信息"
    },
    {
      "id": "s3-113",
      "sectionId": "s3",
      "title": "格式化",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\a`           | 在未对齐和对齐之间切换\n`\\C [STRING]`  | 设置表格标题，如果没有则取消设置\n`\\f [STRING]`  | 显示或设置未对齐的字段分隔符\n`\\H`           | 切换 HTML 输出模式\n`\\t [on\\|off]` | 仅显示行\n`\\T [STRING]`  | 设置或取消设置 HTML \\<table\\> 标签属性\n`\\x [on\\|off]` | 切换扩展输出"
    },
    {
      "id": "s3-114",
      "sectionId": "s3",
      "title": "输入输出",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\copy ...`       | 导入/导出表 _另见：_ [复制](#导入导出-csv)\n`\\echo [STRING]`  | 打印字符串\n`\\i FILE`         | 执行文件\n`\\o [FILE]`       | 将所有结果导出到文件\n`\\qecho [STRING]` | 输出流的字符串"
    },
    {
      "id": "s3-115",
      "sectionId": "s3",
      "title": "变量",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\prompt [TEXT] NAME` | 设置变量\n`\\set [NAME [VALUE]]` | 设置变量 _(如果没有参数，则列出所有变量)_\n`\\unset NAME`         | 删除变量"
    },
    {
      "id": "s3-116",
      "sectionId": "s3",
      "title": "杂项",
      "kind": "text",
      "body": ":- | -\n:- | -\n`\\cd [DIR]`        | 更改目录\n`\\timing [on\\|off]` | 切换时间\n`\\! [COMMAND]`     | 在shell中执行\n`\\! ls -l`         | 在shell中列出所有"
    },
    {
      "id": "s3-117",
      "sectionId": "s3",
      "title": "大对象",
      "kind": "text",
      "body": "• `\\lo_export LOBOID FILE`\n• `\\lo_import FILE [COMMENT]`\n• `\\lo_list`\n• `\\lo_unlink LOBOID`"
    },
    {
      "id": "s4-118",
      "sectionId": "s4",
      "title": "备份",
      "kind": "text",
      "body": "使用 pg_dumpall 备份所有数据库"
    },
    {
      "id": "s4-119",
      "sectionId": "s4",
      "title": "备份",
      "kind": "code",
      "lang": "shell",
      "code": "$ pg_dumpall -U postgres > all.sql"
    },
    {
      "id": "s4-120",
      "sectionId": "s4",
      "title": "备份",
      "kind": "text",
      "body": "使用 pg_dump 备份数据库"
    },
    {
      "id": "s4-121",
      "sectionId": "s4",
      "title": "备份",
      "kind": "code",
      "lang": "shell",
      "code": "$ pg_dump -d mydb -f mydb_backup.sql"
    },
    {
      "id": "s4-122",
      "sectionId": "s4",
      "title": "备份",
      "kind": "text",
      "body": "• &nbsp; `-a` &nbsp; 只转储数据，而不是模式(schema)\n• &nbsp; `-s` &nbsp; 只转储模式，不转储数据\n• &nbsp; `-c` &nbsp; 在重新创建之前删除数据库\n• &nbsp; `-C` &nbsp; 还原前创建数据库\n• &nbsp; `-t` &nbsp; 仅转储命名表\n• &nbsp; `-F` &nbsp; 格式(`c`：自定义，`d`：目录，`t`：tar)"
    },
    {
      "id": "s4-123",
      "sectionId": "s4",
      "title": "备份",
      "kind": "text",
      "body": "使用 `pg_dump -?` 获取完整的选项列表"
    },
    {
      "id": "s4-124",
      "sectionId": "s4",
      "title": "恢复",
      "kind": "text",
      "body": "使用 psql 恢复数据库"
    },
    {
      "id": "s4-125",
      "sectionId": "s4",
      "title": "恢复",
      "kind": "code",
      "lang": "shell",
      "code": "$ psql -U user mydb < mydb_backup.sql"
    },
    {
      "id": "s4-126",
      "sectionId": "s4",
      "title": "恢复",
      "kind": "text",
      "body": "使用 pg_restore 恢复数据库"
    },
    {
      "id": "s4-127",
      "sectionId": "s4",
      "title": "恢复",
      "kind": "code",
      "lang": "shell",
      "code": "$ pg_restore -d mydb mydb_backup.sql -c"
    },
    {
      "id": "s4-128",
      "sectionId": "s4",
      "title": "恢复",
      "kind": "text",
      "body": "• &nbsp; `-U` &nbsp; 指定数据库用户\n• &nbsp; `-c` &nbsp; 在重新创建之前删除数据库\n• &nbsp; `-C` &nbsp; 还原前创建数据库\n• &nbsp; `-e` &nbsp; 如果遇到错误退出\n• &nbsp; `-F` &nbsp; 格式(`c`:自定义，`d`:目录，`t`:tar，`p`:纯文本sql(默认))"
    },
    {
      "id": "s4-129",
      "sectionId": "s4",
      "title": "恢复",
      "kind": "text",
      "body": "使用 `pg_restore -?` 获取完整的选项列表"
    },
    {
      "id": "s4-130",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "text",
      "body": "获取 postgresql.conf 的位置"
    },
    {
      "id": "s4-131",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "code",
      "lang": "shell",
      "code": "$ psql -U postgres -c 'SHOW config_file'"
    },
    {
      "id": "s4-132",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "text",
      "body": "附加到 postgresql.conf"
    },
    {
      "id": "s4-133",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "code",
      "lang": "shell",
      "code": "listen_addresses = '*'"
    },
    {
      "id": "s4-134",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "text",
      "body": "附加到 pg_hba.conf(与 postgresql.conf 相同的位置)"
    },
    {
      "id": "s4-135",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "code",
      "lang": "shell",
      "code": "host  all  all  0.0.0.0/0  md5\nhost  all  all  ::/0       md5"
    },
    {
      "id": "s4-136",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "text",
      "body": "重启 PostgreSQL 服务器"
    },
    {
      "id": "s4-137",
      "sectionId": "s4",
      "title": "远程访问",
      "kind": "code",
      "lang": "shell",
      "code": "$ sudo systemctl restart postgresql"
    },
    {
      "id": "s4-138",
      "sectionId": "s4",
      "title": "导入/导出 CSV",
      "kind": "text",
      "body": "将表格导出为 CSV 文件"
    },
    {
      "id": "s4-139",
      "sectionId": "s4",
      "title": "导入/导出 CSV",
      "kind": "code",
      "lang": "sql",
      "code": "\\copy table TO '<path>' CSV\n\\copy table(col1,col1) TO '<path>' CSV\n\\copy (SELECT...) TO '<path>' CSV"
    },
    {
      "id": "s4-140",
      "sectionId": "s4",
      "title": "导入/导出 CSV",
      "kind": "text",
      "body": "将 CSV 文件导入表格"
    },
    {
      "id": "s4-141",
      "sectionId": "s4",
      "title": "导入/导出 CSV",
      "kind": "code",
      "lang": "sql",
      "code": "\\copy table FROM '<path>' CSV\n\\copy table(col1,col1) FROM '<path>' CSV"
    },
    {
      "id": "s4-142",
      "sectionId": "s4",
      "title": "导入/导出 CSV",
      "kind": "text",
      "body": "另见：[复制](https://www.postgresql.org/docs/current/sql-copy.html)"
    },
    {
      "id": "s4-143",
      "sectionId": "s4",
      "title": "跨版本升级",
      "kind": "text",
      "body": "pg_upgrade 跨版本升级"
    },
    {
      "id": "s4-144",
      "sectionId": "s4",
      "title": "跨版本升级",
      "kind": "code",
      "lang": "shell",
      "code": "$ /usr/lib/postgresql/16/bin/pg_upgrade \\\n  -b /usr/lib/postgresql/15/bin \\\n  -B /usr/lib/postgresql/16/bin \\\n  -d /var/lib/postgresql/15/main \\\n  -D /var/lib/postgresql/16/main \\\n  -o \" -c config_file=/etc/postgresql/15/main/postgresql.conf\" \\\n  -O \" -c config_file=/etc/postgresql/16/main/postgresql.conf\""
    },
    {
      "id": "s4-145",
      "sectionId": "s4",
      "title": "跨版本升级",
      "kind": "text",
      "body": "• &nbsp; `-b` &nbsp; 旧版本二进制文件目录\n• &nbsp; `-B` &nbsp; 新版本二进制文件目录\n• &nbsp; `-d` &nbsp; 旧版本数据目录\n• &nbsp; `-D` &nbsp; 新版本数据目录\n• &nbsp; `-o` &nbsp; 旧版本主配置文件\n• &nbsp; `-O` &nbsp; 新版本主配置文件\n• &nbsp; `-c` &nbsp; 仅`check`，不执行升级，可先加`-c`检查是否有报错，没有报错再运行升级"
    },
    {
      "id": "s4-146",
      "sectionId": "s4",
      "title": "跨版本升级",
      "kind": "text",
      "body": "使用 `pg_upgrade -?` 获取完整的选项列表"
    },
    {
      "id": "s5-147",
      "sectionId": "s5",
      "title": "另见",
      "kind": "text",
      "body": "• [Posgres-cheatsheet](https://gist.github.com/apolloclark/ea5466d5929e63043dcf#posgres-cheatsheet) _(gist.github.com)_"
    }
  ],
  "source": {
    "repo": "https://github.com/jaywcjlove/reference",
    "path": "docs/postgres.md",
    "ref": "main",
    "url": "https://github.com/jaywcjlove/reference/tree/main/docs/postgres.md",
    "lang": "zh",
    "mode": "local"
  }
}
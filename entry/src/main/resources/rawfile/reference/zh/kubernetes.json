{
  "id": "kubernetes",
  "name": "Kubernetes 备忘清单",
  "title": "Kubernetes 备忘清单",
  "icon": "reference/icons/zh/kubernetes.svg",
  "sections": [
    {
      "id": "intro",
      "title": "简介",
      "startIndex": 0
    },
    {
      "id": "s1",
      "title": "查看资源信息",
      "startIndex": 0
    },
    {
      "id": "s2",
      "title": "变更资源属性",
      "startIndex": 32
    },
    {
      "id": "s3",
      "title": "添加资源",
      "startIndex": 42
    },
    {
      "id": "s4",
      "title": "请求",
      "startIndex": 48
    },
    {
      "id": "s5",
      "title": "另见",
      "startIndex": 50
    }
  ],
  "cards": [
    {
      "id": "s1-0",
      "sectionId": "s1",
      "title": "%E8%8A%82%E7%82%B9",
      "body": "%E8%B5%84%E6%BA%90%E5%90%8D%E7%A7%B0%3A%20nodes%2C%20%E7%BC%A9%E5%86%99%3A%20no%0A%0A%60%60%60bash%0A%24%20kubectl%20get%20no%20%20%20%20%20%20%20%20%20%20%23%20%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E4%BF%A1%E6%81%AF%0A%23%20%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E7%9A%84%E6%9B%B4%E5%A4%9A%E4%BF%A1%E6%81%AF%0A%24%20kubectl%20get%20no%20-o%20wide%20%20%0A%24%20kubectl%20describe%20no%20%20%20%20%20%23%20%E6%98%BE%E7%A4%BA%E8%8A%82%E7%82%B9%E8%AF%A6%E6%83%85%0A%23%20%E4%BB%A5yaml%E6%A0%BC%E5%BC%8F%EF%BC%8C%E6%98%BE%E7%A4%BA%E8%8A%82%E7%82%B9%E8%AF%A6%E6%83%85%0A%24%20kubectl%20get%20no%20-o%20yaml%20%20%0A%23%20%E7%AD%9B%E9%80%89%E6%8C%87%E5%AE%9A%E6%A0%87%E7%AD%BE%E7%9A%84%E8%8A%82%E7%82%B9%0A%24%20kubectl%20get%20node%20--selector%3D%5Blabel_name%5D%20%0A%23%20%E8%BE%93%E5%87%BA%20jsonpath%20%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AD%97%E6%AE%B5%E4%BF%A1%E6%81%AF%0A%24%20kubectl%20get%20nodes%20-o%20jsonpath%3D'%7B.items%5B*%5D.status.addresses%5B%3F(%40.type%3D%3D%22ExternalIP%22)%5D.address%7D'%0A%23%20%E6%98%BE%E7%A4%BA%E8%8A%82%E7%82%B9(CPU%2F%E5%86%85%E5%AD%98%2F%E5%AD%98%E5%82%A8)%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5%0A%24%20kubectl%20top%20node%20%5Bnode_name%5D%0A%60%60%60",
      "encoded": true
    },
    {
      "id": "s1-2",
      "sectionId": "s1",
      "title": "容器组",
      "body": "资源名称: pods, 缩写: po\n\n```bash\n$ kubectl get po              # 显示所有容器组信息\n$ kubectl get po -o wide\n$ kubectl describe po\n$ kubectl get po --show-labels # 查看容器组的labels\n$ kubectl get po -l app=nginx\n$ kubectl get po -o yaml\n$ kubectl get pod [pod_name] -o yaml --export\n$ kubectl get pod [pod_name] -o yaml --export > nameoffile.yaml \n# 以yaml格式导出容器组信息到yaml文件\n$ kubectl get pods --field-selector status.phase=Running     \n# 使用字段选择器筛选出容器组信息\n```"
    },
    {
      "id": "s1-4",
      "sectionId": "s1",
      "title": "命名空间",
      "body": "资源名称: `namespaces`, 缩写: `ns`\n\n```bash\n$ kubectl get ns\n$ kubectl get ns -o yaml\n$ kubectl describe ns\n```"
    },
    {
      "id": "s1-6",
      "sectionId": "s1",
      "title": "无状态",
      "body": "资源名称: `deployments`, 缩写: `deploy`\n\n```bash\n$ kubectl get deploy\n$ kubectl describe deploy\n$ kubectl get deploy -o wide \n$ kubectl get deploy -o yaml\n```"
    },
    {
      "id": "s1-8",
      "sectionId": "s1",
      "title": "服务",
      "body": "资源名称: `services`, 缩写: `svc`\n\n```bash\n$ kubectl get svc\n$ kubectl describe svc\n$ kubectl get svc -o wide \n$ kubectl get svc -o yaml\n$ kubectl get svc --show-labels\n```"
    },
    {
      "id": "s1-10",
      "sectionId": "s1",
      "title": "守护进程集",
      "body": "资源名称: `daemonsets`, 缩写: `ds`\n\n```bash\n$ kubectl get ds\n$ kubectl describe ds --all-namespaces\n$ kubectl describe ds [daemonset_name] -n [namespace_name]\n$ kubectl get ds [ds_name] -n [ns_name] -o yaml\n```"
    },
    {
      "id": "s1-12",
      "sectionId": "s1",
      "title": "事件",
      "body": "资源名称: `events`, 缩写: `ev`\n\n```bash\n$ kubectl get events \n$ kubectl get events -n kube-system\n$ kubectl get events -w\n```"
    },
    {
      "id": "s1-14",
      "sectionId": "s1",
      "title": "服务帐户",
      "body": "资源名称: `serviceaccounts`, 缩写: `sa`\n\n```bash\n$ kubectl get sa\n$ kubectl get sa -o yaml\n$ kubectl get serviceaccounts default -o yaml >./sa.yaml\n$ kubectl replace serviceaccount default -f ./sa.yaml\n```"
    },
    {
      "id": "s1-16",
      "sectionId": "s1",
      "title": "日志",
      "body": "```bash\n$ kubectl logs [pod_name]\n$ kubectl logs --since=1h [pod_name]\n$ kubectl logs --tail=20 [pod_name]\n$ kubectl logs \\\n      -f -c [container_name] [pod_name]\n$ kubectl logs [pod_name] > pod.log\n```"
    },
    {
      "id": "s1-17",
      "sectionId": "s1",
      "title": "副本集",
      "body": "资源名称: replicasets, 缩写: rs\n\n```bash\n$ kubectl get rs\n$ kubectl describe rs\n$ kubectl get rs -o wide \n$ kubectl get rs -o yaml\n```"
    },
    {
      "id": "s1-19",
      "sectionId": "s1",
      "title": "角色",
      "body": "```bash\n$ kubectl get roles --all-namespaces\n```\n\n```\n$ kubectl get roles \\\n      --all-namespaces -o yaml\n```"
    },
    {
      "id": "s1-20",
      "sectionId": "s1",
      "title": "保密字典",
      "body": "```bash\n$ kubectl get secrets\n$ kubectl get secrets --all-namespaces \n$ kubectl get secrets -o yaml\n```"
    },
    {
      "id": "s1-21",
      "sectionId": "s1",
      "title": "配置项",
      "body": "资源名称: configmaps, 缩写: cm\n\n```bash\n$ kubectl get cm\n$ kubectl get cm --all-namespaces\n$ kubectl get cm --all-namespaces -o yaml\n```"
    },
    {
      "id": "s1-23",
      "sectionId": "s1",
      "title": "路由",
      "body": "资源名称: ingresses, 缩写: ing\n\n```bash\n$ kubectl get ing\n$ kubectl get ing --all-namespaces\n```"
    },
    {
      "id": "s1-25",
      "sectionId": "s1",
      "title": "持久卷",
      "body": "资源名称: persistentvolumes, 缩写: pv\n\n```bash\n$ kubectl get pv \n$ kubectl describe pv\n```"
    },
    {
      "id": "s1-27",
      "sectionId": "s1",
      "title": "持久卷声明",
      "body": "资源名称: persistentvolumeclaims, 缩写: pvc\n\n```bash\n$ kubectl get pvc\n$ kubectl describe pvc\n```"
    },
    {
      "id": "s1-29",
      "sectionId": "s1",
      "title": "存储类",
      "body": "资源名称: storageclasses, 缩写: sc\n\n```bash\n$ kubectl get sc\n$ kubectl get sc -o yaml\n```"
    },
    {
      "id": "s1-31",
      "sectionId": "s1",
      "title": "多个资源",
      "body": "```bash\n$ kubectl get svc, po\n$ kubectl get deploy, no\n$ kubectl get all\n$ kubectl get all --all-namespaces\n```"
    },
    {
      "id": "s2-32",
      "sectionId": "s2",
      "title": "污点",
      "body": "```bash\n$ kubectl taint [node_name] [taint_name]\n```"
    },
    {
      "id": "s2-33",
      "sectionId": "s2",
      "title": "标签",
      "body": "```bash\n$ kubectl label nodes <node-name> <label-key>=<label-value>  #增加\n$ kubectl label nodes <node-name> <label-key>- #删除\n$ kubectl label nodes <node-name> <label-key>=<label-value> --overwrite #修改\n```"
    },
    {
      "id": "s2-34",
      "sectionId": "s2",
      "title": "维护/可调度",
      "body": "```bash\n$ kubectl cordon [node_name]   # 节点维护\n$ kubectl uncordon [node_name] # 节点可调度\n```"
    },
    {
      "id": "s2-35",
      "sectionId": "s2",
      "title": "清空节点",
      "body": "```bash\n$ kubectl drain [node_name]    # 清空节点\n```"
    },
    {
      "id": "s2-36",
      "sectionId": "s2",
      "title": "节点/容器组",
      "body": "```bash\n$ kubectl delete node [node_name] \n$ kubectl delete pod [pod_name]\n$ kubectl edit node [node_name]\n$ kubectl edit pod [pod_name]\n```"
    },
    {
      "id": "s2-37",
      "sectionId": "s2",
      "title": "无状态/命名空间",
      "body": "```bash\n$ kubectl edit deploy [deploy_name]\n$ kubectl delete deploy [deploy_name]\n$ kubectl expose deploy [deploy_name] --port=80 --type=NodePort\n$ kubectl scale deploy [deploy_name] --replicas=5\n$ kubectl delete ns\n$ kubectl edit ns [ns_name]\n```"
    },
    {
      "id": "s2-38",
      "sectionId": "s2",
      "title": "服务",
      "body": "```bash\n$ kubectl edit svc [svc_name]\n$ kubectl delete svc [svc_name]\n```"
    },
    {
      "id": "s2-39",
      "sectionId": "s2",
      "title": "守护进程集",
      "body": "```bash\n$ kubectl edit ds [ds_name] -n kube-system \n$ kubectl delete ds [ds_name]\n```"
    },
    {
      "id": "s2-40",
      "sectionId": "s2",
      "title": "服务账号",
      "body": "```bash\n$ kubectl edit sa [sa_name]\n$ kubectl delete sa [sa_name]\n```"
    },
    {
      "id": "s2-41",
      "sectionId": "s2",
      "title": "注释",
      "body": "```bash\n$ kubectl annotatepo [pod_name] [annotation]\n$ kubectl annotateno [node_name]\n```"
    },
    {
      "id": "s3-42",
      "sectionId": "s3",
      "title": "创建容器组",
      "body": "```bash\n$ kubectl create -f [name_of_file] \n$ kubectl apply -f [name_of_file]\n$ kubectl run [pod_name] --image=nginx --restart=Never\n$ kubectl run [pod_name] --generator=run-pod/v1 --image=nginx\n$ kubectl run [pod_name] --image=nginx --restart=Never\n```"
    },
    {
      "id": "s3-43",
      "sectionId": "s3",
      "title": "创建服务",
      "body": "```bash\n$ kubectl create svc nodeport [svc_name] \\\n      --tcp=8080:80\n```"
    },
    {
      "id": "s3-44",
      "sectionId": "s3",
      "title": "创建无状态应用",
      "body": "```bash\n$ kubectl create -f [name_of_file] \n$ kubectl apply -f [name_of_file]\n$ kubectl create deploy [deploy_name] \\\n      --image=nginx\n```"
    },
    {
      "id": "s3-45",
      "sectionId": "s3",
      "title": "输出YAML文件",
      "body": "```bash\n$ kubectl create deploy [deploy_name] --image=nginx --dry-run -o yaml > deploy.yaml\n$ kubectl get po [pod_name] -o yaml --export > pod.yaml\n$ kubectl run nginx --image=nginx:alpine --dry-run -o -yaml > deploy.yaml\n```"
    },
    {
      "id": "s3-46",
      "sectionId": "s3",
      "title": "容器交互",
      "body": "```bash\n$ kubectl run [pod_name] \\\n        --image=busybox --rm -it \\\n        --restart=Never -- sh\n```"
    },
    {
      "id": "s3-47",
      "sectionId": "s3",
      "title": "获取帮助",
      "body": "```bash\n$ kubectl -h\n$ kubectl create -h\n$ kubectl run -h\n$ kubectl explain deploy.spec\n```"
    },
    {
      "id": "s4-48",
      "sectionId": "s4",
      "title": "API调用",
      "body": "```bash\n$ kubectl get --raw /apis/metrics.k8s.io/\n```"
    },
    {
      "id": "s4-49",
      "sectionId": "s4",
      "title": "集群信息",
      "body": "```bash\n$ kubectl config\n$ kubectl cluster-info\n$ kubectl get componentstatus\n```"
    },
    {
      "id": "s5-50",
      "sectionId": "s5",
      "title": "另见",
      "body": "• [Kubernetes 官方文档 命令行工具 (kubectl)](https://kubernetes.io/zh-cn/docs/reference/kubectl/) _(kubernetes.io)_"
    }
  ],
  "source": {
    "repo": "https://github.com/jaywcjlove/reference",
    "path": "docs/kubernetes.md",
    "ref": "main",
    "url": "https://github.com/jaywcjlove/reference/tree/main/docs/kubernetes.md",
    "lang": "zh",
    "mode": "local"
  }
}